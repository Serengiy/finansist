import{y as I,r as s,L as K,B as P,o as u,n as i,a as l,w as t,k as F,F as V,d as x,q as _,b as S,f as g,D as k,i as m,v as p,H as T,t as w,P as f,N as $}from"./app-64dafc3a.js";import{Q as z}from"./QSpace-767f85f1.js";import{Q as D,a as E}from"./QTable-9f10ca35.js";import{Q as C}from"./QPagination-9c29fd07.js";import"./QSelect-fcdeceb1.js";import"./QChip-18101fab.js";import"./position-engine-f936ecea.js";const O={key:0},H={key:1},L={key:2},R={class:"flex flex-center"},W={class:"flex flex-center"},ee={__name:"InvalidCards",setup(Z){const Q=I(),v=s(),o=s({});s(),s();const r=async d=>{f.show();try{const a=await axios.get("/api/invalid-cards",{params:{...o.value,page:d}}),{data:c,meta:e}=a.data;v.value=c,b.value=e.last_page,n.value=e.current_page,N.value=e.total}catch(a){console.error(a)}f.hide()},y=async d=>{f.show();try{(await axios.post(`/api/collect-cards/${d}`)).data.success&&$.create({color:"green-4",message:"Карточки товаров начали загружаться, это займет некоторое время",timeout:5e3})}catch(a){console.error(a)}f.hide()};K(()=>{Q.name==="InvalidCards"&&r()});const b=s(0),n=s(0),h=s({}),N=s(0);P(n,d=>{r(d)});const B={rowsNumber:50},U=()=>{o.value={...h.value},n.value=1,r()},q=[{label:"Маректплейс",name:"marketplace",field:"marketplace",sortable:!1,align:"left"},{label:"Баркод",name:"barcode",field:"barcode",sortable:!1,align:"left"},{label:"Ошибка",name:"error",field:"error",sortable:!1,align:"left"}];return(d,a)=>{var c;return u(),i(V,null,[l(F,null,{default:t(()=>[l(S,{class:"row q-gutter-sm items-start"},{default:t(()=>[l(g,{class:"col-2",modelValue:o.value.barcode,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value.barcode=e),clearable:"",dense:"","hide-details":"",label:"Штрихкод",outlined:"",onKeypress:k(r,["enter"])},null,8,["modelValue"]),l(g,{class:"col-2",modelValue:o.value.marketplace,"onUpdate:modelValue":a[1]||(a[1]=e=>o.value.marketplace=e),clearable:"",dense:"","hide-details":"",label:"Маркетплейс",outlined:"",onKeypress:k(r,["enter"])},null,8,["modelValue"]),l(g,{class:"col-3",modelValue:o.value.error,"onUpdate:modelValue":a[2]||(a[2]=e=>o.value.error=e),clearable:"",dense:"","hide-details":"",label:"Поиск по ошибке",outlined:"",onKeypress:k(r,["enter"])},null,8,["modelValue"]),l(z),l(m,{color:"purple",outlined:"",onClick:a[3]||(a[3]=e=>y("wb"))},{default:t(()=>[p("Проверить WB")]),_:1}),l(m,{color:"blue",outlined:"",onClick:a[4]||(a[4]=e=>y("ozon"))},{default:t(()=>[p("Проверить OZON")]),_:1}),l(m,{color:"green",outlined:"",onClick:r},{default:t(()=>[p("Искать")]),_:1}),l(m,{color:"red",outlined:"",onClick:U},{default:t(()=>[p("Сбросить")]),_:1})]),_:1})]),_:1}),(c=v.value)!=null&&c.length?(u(),i(V,{key:0},[l(D,{columns:q,pagination:B,rows:v.value,dense:"","hide-bottom":"","row-key":"id",title:"Характеристики","virtual-scroll":"","wrap-cells":""},{"body-cell":t(e=>[l(E,{class:T(e.row.is_wrong?"bg-red-2":e.row.is_validated?"bg-green-2":""),item:e},{default:t(()=>[e.col.name=="barcode"?(u(),i("p",O,w(e.row.barcode),1)):e.col.name=="marketplace"?(u(),i("p",H,w(e.row.marketplace),1)):e.col.name=="error"?(u(),i("p",L,w(e.row.error),1)):_("",!0)]),_:2},1032,["class","item"])]),_:1},8,["rows"]),x("div",R,[l(C,{modelValue:n.value,"onUpdate:modelValue":a[5]||(a[5]=e=>n.value=e),max:b.value,"max-pages":6,"boundary-links":"","boundary-numbers":"",class:"q-mt-md","direction-links":""},null,8,["modelValue","max"])]),x("div",W,[l(C,{modelValue:n.value,"onUpdate:modelValue":a[6]||(a[6]=e=>n.value=e),"boundary-links":!1,"direction-links":!1,max:b.value,"max-pages":6,class:"q-mt-md",input:""},null,8,["modelValue","max"])])],64)):_("",!0)],64)}}};export{ee as default};
