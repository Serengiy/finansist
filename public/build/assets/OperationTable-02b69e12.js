import{r as M,A as S,o as a,s as n,a as f,w,F as m,v as h,t as p,l,x as $,b as k,c as P,q as z,n as L,P as A,N as I}from"./app-5d15a536.js";import{a as G,Q as H}from"./QTable-57e6cd3b.js";import{Q as J}from"./QPagination-45fdab11.js";const K={key:0,class:"shadow-3"},W={key:0},X={class:"text-primary"},Y={key:0},Z={key:4},ee={class:"row bg-white justify-center q-pb-md rounded-borders"},ae={key:1,class:"row q-mt-sm bg-white justify-center q-pb-md rounded-borders shadow-3"},re={__name:"OperationTable",props:{operations:Array,pagination:Object},emits:["update:pagination","refresh"],setup(i,{emit:T}){const U=i,D=M([{name:"sber_amountRub",label:"Сумма",field:"sber_amountRub",align:"left",sortable:!0,sort:(t,o)=>parseInt(t,10)-parseInt(o,10)},{name:"categories",label:"Категория",field:"categories",align:"left",sortable:!0,sort:(t,o,r,e)=>{var c,u,_,y;const b=((u=(c=r.categories)==null?void 0:c[0])==null?void 0:u.name)||"",g=((y=(_=e.categories)==null?void 0:_[0])==null?void 0:y.name)||"";return b.localeCompare(g)}},{name:"contractor",label:"Контрагент",field:"payee_contractor",align:"left",sortable:!0,sort:(t,o,r,e)=>{var c,u;const b=((c=r.payee_contractor)==null?void 0:c.full_name)||"",g=((u=e.payee_contractor)==null?void 0:u.full_name)||"";return b.localeCompare(g)}},{name:"is_manual",label:"is manual",field:"is_manual",align:"left",sortable:!0,sort:(t,o)=>Number(t)-Number(o)},{name:"actions",label:"Действия",align:"left"},{name:"date_at",label:"Дата",field:"date_at",align:"left",sortable:!0,sort:(t,o)=>new Date(t)-new Date(o)},{name:"sber_paymentPurpose",label:"Назначение",field:"sber_paymentPurpose",align:"left"}]),E=T,O=t=>{E("update:pagination",{...U.pagination,page:t})},F=async t=>{var o;A.show();try{const r=await axios.put(`/api/operations/${t==null?void 0:t.id}`,{is_manual:t.is_manual});(o=r==null?void 0:r.data)!=null&&o.success&&I.create({message:"Обновлено",color:"green",timeout:2e3})}catch{I.create({message:"Ошибка обновления",color:"red",timeout:2e3})}A.hide()};return(t,o)=>{const r=S("router-link");return i.operations.length?(a(),n("div",K,[f(H,{flat:"",class:"q-mt-md q-px-sm",rows:i.operations,pagination:{rowsPerPage:i.pagination.rowsPerPage},columns:D.value,"row-key":"id","hide-bottom":""},{"body-cell":w(e=>[f(G,{item:e},{default:w(()=>{var b,g,c,u,_,y,v,C,N,V,q,Q,B,R,j;return[e.col.name==="sber_amountRub"?(a(),n(m,{key:0},[h(p((b=e.row)==null?void 0:b.sber_amountRub),1)],64)):l("",!0),e.col.name==="categories"?(a(),n(m,{key:1},[((g=e.row)==null?void 0:g.categories.length)>1?(a(),n("span",W,[(a(!0),n(m,null,$(e.row.categories,(s,d)=>(a(),n("span",null,[h(p(s.name)+" ",1),k("span",X," ("+p(s.sber_amountRub)+") ",1),d<e.row.categories.length-1?(a(),n("span",Y,", ")):l("",!0)]))),256))])):(a(),n(m,{key:1},[(_=(u=(c=e.row)==null?void 0:c.categories)==null?void 0:u[0])!=null&&_.id?(a(),P(r,{key:0,to:{name:"CategoriesEdit",params:{id:(C=(v=(y=e.row)==null?void 0:y.categories)==null?void 0:v[0])==null?void 0:C.id}},target:"_blank"},{default:w(()=>{var s,d;return[h(p((d=(s=e.row)==null?void 0:s.categories)==null?void 0:d.map(x=>x==null?void 0:x.name).join(", ")),1)]}),_:2},1032,["to"])):l("",!0)],64))],64)):l("",!0),e.col.name==="contractor"?(a(),n(m,{key:2},[(V=(N=e.row)==null?void 0:N.payee_contractor)!=null&&V.id?(a(),P(r,{key:0,to:{name:"ContractorShow",params:{id:(Q=(q=e.row)==null?void 0:q.payee_contractor)==null?void 0:Q.id}},target:"_blank"},{default:w(()=>{var s,d;return[k("div",null,p((d=(s=e.row)==null?void 0:s.payee_contractor)==null?void 0:d.full_name),1)]}),_:2},1032,["to"])):l("",!0)],64)):l("",!0),e.col.name==="is_manual"?(a(),P(z,{key:3,"onUpdate:modelValue":[s=>e.row.is_manual=s,s=>F(e.row)],"model-value":e.row.is_manual},null,8,["onUpdate:modelValue","model-value"])):l("",!0),e.col.name==="actions"?(a(),n("div",Z,[f(r,{to:{name:"OperationEdit",params:{id:(B=e==null?void 0:e.row)==null?void 0:B.id}},class:"cursor-pointer"},{default:w(()=>[f(L,{color:"primary",size:"xs",name:"edit",class:"cursor-pointer"})]),_:2},1032,["to"])])):l("",!0),e.col.name==="date_at"?(a(),n(m,{key:5},[h(p((R=e.row)==null?void 0:R.date_at),1)],64)):l("",!0),e.col.name==="sber_paymentPurpose"?(a(),n(m,{key:6},[h(p((j=e.row)==null?void 0:j.sber_paymentPurpose),1)],64)):l("",!0)]}),_:2},1032,["item"])]),_:1},8,["rows","pagination","columns"]),k("div",ee,[f(J,{modelValue:i.pagination.page,"onUpdate:modelValue":[o[0]||(o[0]=e=>i.pagination.page=e),O],max:Math.ceil(i.pagination.rowsNumber/i.pagination.rowsPerPage),"boundary-numbers":"","boundary-links":"","max-pages":10,class:"text-center q-mt-md"},null,8,["modelValue","max"])])])):(a(),n("div",ae,o[1]||(o[1]=[k("p",{class:"text-h6"}," Для этого контрагента операции не найдены ",-1)])))}}};export{re as _};
