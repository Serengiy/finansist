import{Q as N}from"./QSelect-fcdeceb1.js";import{x as S,y as U,z as j,r as m,L as F,B as K,C as T,o as a,n as r,a as u,w as i,k as D,F as t,d as o,t as n,q as d,b as E,f as h,D as Q,i as x,v as s,c as V,P as C}from"./app-64dafc3a.js";import{Q as R}from"./QSpace-767f85f1.js";import{Q as W,a as L}from"./QTable-9f10ca35.js";import{Q as O}from"./QPagination-9c29fd07.js";import"./QChip-18101fab.js";import"./position-engine-f936ecea.js";const M={class:"q-my-lg text-bold text-center row justify-center"},A={class:"text-left q-px-lg"},G=o("div",null,[o("div",null,"|"),o("div",null,"|"),o("div",null,"|")],-1),H={class:"text-left q-px-lg"},J={class:"flex flex-center"},X={class:"flex flex-center"},te={__name:"Index",setup(Y){S();const P=U();j("auth");const g=m(),c=m({});m();const w=m(),f=m(),y=m(0),p=m(0),q=m({}),z={rowsPerPage:50},v=async b=>{C.show();try{const l=await axios.get("/api/orders",{params:{...c.value,page:b}});w.value=l.data.currentOrders,f.value=l.data.yesterdayOrders,console.log(f.value);const{data:k,meta:_}=l.data;g.value=k,p.value=_.current_page,y.value=_.last_page}catch(l){console.error(l)}C.hide()};F(()=>{P.name==="OrderIndex"&&v()}),K(p,b=>{v(b)});const B=()=>{c.value={...q.value},p.value=1,v()},I=[{label:"Маркетплейс",name:"marketplace",field:"marketplace",sortable:!1,align:"left"},{label:"Статус",name:"status",field:"status",sortable:!1,align:"left"},{label:"Номер заказа",name:"order_id",field:"order_id",sortable:!1,align:"left"},{label:"Баркод",name:"barcode",field:"barcode",sortable:!1,align:"left"},{label:"Номер резерва",name:"reserve_id",field:"reserve_id",sortable:!1,align:"left"},{label:"Дата заказа",name:"order_date",field:"order_date",sortable:!1,align:"left"},{label:"Действия",name:"actions",field:"actions",sortable:!1,align:"left"}];return(b,l)=>{var _;const k=T("router-link");return a(),r(t,null,[u(D,null,{default:i(()=>[u(E,{class:"row q-gutter-sm justify-between items-start"},{default:i(()=>[u(N,{class:"col-1",modelValue:c.value.mp,"onUpdate:modelValue":l[0]||(l[0]=e=>c.value.mp=e),options:[{mp:"wb",name:"Wildberries"},{mp:"ozon",name:"Ozon"}],"option-label":"name","option-value":"mp",label:"Маркетплей",clearable:"",dense:"","emit-value":"",outlined:"","use-chips":""},null,8,["modelValue"]),u(h,{class:"col-1",modelValue:c.value.order_id,"onUpdate:modelValue":l[1]||(l[1]=e=>c.value.order_id=e),clearable:"",dense:"","hide-details":"",label:"Номер заказа",outlined:"",onKeypress:Q(v,["enter"])},null,8,["modelValue"]),u(h,{class:"col-1",modelValue:c.value.reserve_id,"onUpdate:modelValue":l[2]||(l[2]=e=>c.value.reserve_id=e),clearable:"",dense:"","hide-details":"",label:"Номер резерва",outlined:"",onKeypress:Q(v,["enter"])},null,8,["modelValue"]),u(R),u(x,{color:"green",outlined:"",onClick:v},{default:i(()=>[s("Искать")]),_:1}),u(x,{color:"red",outlined:"",onClick:B},{default:i(()=>[s("Сбросить")]),_:1})]),_:1})]),_:1}),(_=g.value)!=null&&_.length?(a(),r(t,{key:0},[o("div",M,[o("div",A,[o("div",null,n(f.value.date),1),o("div",null," Всего заказов: "+n(f.value.totalCount),1),o("div",null," Всего несобранных: "+n(f.value.countNotPacked),1)]),G,o("div",H,[o("div",null,n(w.value.date),1),o("div",null," Всего заказов: "+n(w.value.totalCount),1),o("div",null," Всего несобранных: "+n(w.value.countNotPacked),1)])]),u(W,{columns:I,pagination:z,rows:g.value,dense:"","hide-bottom":"","row-key":"id",title:"Заказы","virtual-scroll":"","wrap-cells":""},{"body-cell":i(e=>[u(L,null,{default:i(()=>[e.col.name=="marketplace"?(a(),r(t,{key:0},[s(n(e.row.marketplace),1)],64)):d("",!0),e.col.name=="status"?(a(),r(t,{key:1},[e.row.status==="confirmed"||e.row.status==="packed"?(a(),r(t,{key:0},[s(" Собран ")],64)):d("",!0),e.row.status==="new"?(a(),r(t,{key:1},[s(" Новый ")],64)):d("",!0),e.row.status==="processing"?(a(),r(t,{key:2},[s(" В процессе сборки ")],64)):d("",!0),e.row.status==="delivering"||e.row.status==="completed"?(a(),r(t,{key:3},[s(" Доставляется ")],64)):d("",!0)],64)):e.col.name=="order_id"?(a(),r(t,{key:2},[e.row.status==="new"||e.row.status==="awaiting_packaging"?(a(),r(t,{key:0},[e.row.marketplace==="wb"?(a(),V(k,{key:0,to:{name:"OrderShowWb",params:{orderId:e.row.order_id}}},{default:i(()=>[s(n(e.row.order_id),1)]),_:2},1032,["to"])):d("",!0),e.row.marketplace==="ozon"?(a(),V(k,{key:1,to:{name:"OrderShowOzon",params:{orderId:e.row.order_id}}},{default:i(()=>[s(n(e.row.order_id),1)]),_:2},1032,["to"])):d("",!0)],64)):(a(),r(t,{key:1},[s(n(e.row.order_id),1)],64))],64)):d("",!0),e.col.name=="reserve_id"?(a(),r(t,{key:3},[s(n(e.row.reserve_id),1)],64)):d("",!0),e.col.name=="barcode"?(a(),r(t,{key:4},[s(n(e.row.barcode),1)],64)):d("",!0),e.col.name=="order_date"?(a(),r(t,{key:5},[s(n(e.row.order_date),1)],64)):d("",!0),e.col.name=="actions"&&e.row.reserve_id&&["new","processing"].includes(e.row.status)?(a(),V(x,{key:6,to:{name:"ManageOrder",params:{orderId:e.row.order_id}},color:"blue",dense:"",outlined:"",size:"sm"},{default:i(()=>[s("Управление заказом")]),_:2},1032,["to"])):d("",!0)]),_:2},1024)]),_:1},8,["rows"]),o("div",J,[u(O,{modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=e=>p.value=e),max:y.value,"max-pages":6,"boundary-links":"","boundary-numbers":"",class:"q-mt-md","direction-links":""},null,8,["modelValue","max"])]),o("div",X,[u(O,{modelValue:p.value,"onUpdate:modelValue":l[4]||(l[4]=e=>p.value=e),"boundary-links":!1,"direction-links":!1,max:y.value,"max-pages":6,class:"q-mt-md",disable:"",input:""},null,8,["modelValue","max"])])],64)):d("",!0)],64)}}};export{te as default};
