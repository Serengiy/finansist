import{Q as z}from"./QSelect-fcdeceb1.js";import{x as I,y as P,z as R,r as f,L as F,B as K,C as T,o,n as r,a as l,w as n,k as j,F as u,d as w,q as m,b as D,f as x,D as V,i as g,v as s,t as v,c as h,P as _,N as E}from"./app-64dafc3a.js";import{Q as W}from"./QSpace-767f85f1.js";import{Q as $,a as L}from"./QTable-9f10ca35.js";import{Q}from"./QPagination-9c29fd07.js";import"./QChip-18101fab.js";import"./position-engine-f936ecea.js";const O={class:"flex flex-center"},A={class:"flex flex-center"},le={__name:"Index",setup(G){I();const C=P();R("auth");const d=f(0),b=f(0),y=f(),t=f({}),i=async c=>{_.show();try{const a=await axios.get("/api/reserves",{params:{...t.value,page:c}}),{data:k,meta:p}=a.data;y.value=k,d.value=p.current_page,b.value=p.last_page}catch(a){console.error(a)}_.hide()},B=async c=>{_.show();try{(await axios.post(`/api/reserves/move/${c}`)).data.success&&E.create({message:"Резерв перемещен",color:"green"})}catch(a){console.log(a),_.hide()}_.hide()};F(()=>{C.name==="ReserveIndex"&&i()}),K(d,c=>{i(c)});const N=f({}),S={rowsNumber:50},U=()=>{t.value={...N.value},d.value=1,i()},q=[{label:"Маркетплейс",name:"marketplace",field:"marketplace",sortable:!1,align:"left"},{label:"Номер резерва",name:"reserve_id",field:"reserve_id",sortable:!1,align:"left"},{label:"Номер поставки WB",name:"supply_id",field:"supply_id",sortable:!1,align:"left"},{label:"Магазин резерва",name:"shop",field:"shop",sortable:!1,align:"left"},{label:"Кол-во заказов",name:"orders_count",field:"orders_count",sortable:!1,align:"left"},{label:"Перемещение",name:"moved_uid",sortable:!1,align:"left"}];return(c,a)=>{var p;const k=T("router-link");return o(),r(u,null,[l(j,null,{default:n(()=>[l(D,{class:"row q-gutter-sm justify-between items-start"},{default:n(()=>[l(z,{class:"col-1",modelValue:t.value.mp,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.mp=e),options:[{mp:"wb",name:"Wildberries"},{mp:"ozon",name:"Ozon"}],"option-label":"name","option-value":"mp",label:"Маркетплей",clearable:"",dense:"","emit-value":"",outlined:"","use-chips":""},null,8,["modelValue"]),l(x,{class:"col-1",modelValue:t.value.reserve_id,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value.reserve_id=e),clearable:"",dense:"","hide-details":"",label:"Номер резерва",outlined:"",onKeypress:V(i,["enter"])},null,8,["modelValue"]),l(x,{class:"col-1",modelValue:t.value.shop,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.shop=e),clearable:"",dense:"","hide-details":"",label:"Магазин",outlined:"",onKeypress:V(i,["enter"])},null,8,["modelValue"]),l(W),l(g,{color:"green",outlined:"",onClick:i},{default:n(()=>[s("Искать")]),_:1}),l(g,{color:"red",outlined:"",onClick:U},{default:n(()=>[s("Сбросить")]),_:1})]),_:1})]),_:1}),(p=y.value)!=null&&p.length?(o(),r(u,{key:0},[l($,{columns:q,pagination:S,rows:y.value,dense:"","hide-bottom":"","row-key":"id",title:"Резервы","virtual-scroll":"","wrap-cells":""},{"body-cell":n(e=>[l(L,null,{default:n(()=>[e.col.name=="marketplace"?(o(),r(u,{key:0},[s(v(e.row.marketplace),1)],64)):m("",!0),e.col.name=="reserve_id"?(o(),h(k,{key:1,to:{name:"ReserveShow",params:{reserveId:e.row.id}}},{default:n(()=>[s(v(e.row.reserve_id),1)]),_:2},1032,["to"])):m("",!0),e.col.name=="supply_id"?(o(),r(u,{key:2},[s(v(e.row.supply_id),1)],64)):m("",!0),e.col.name=="shop"?(o(),r(u,{key:3},[s(v(e.row.shop),1)],64)):m("",!0),e.col.name=="orders_count"?(o(),r(u,{key:4},[s(v(e.row.orders_count),1)],64)):e.col.name=="moved_uid"?(o(),r(u,{key:5},[e.row.moved_uid===null?(o(),h(g,{key:0,onClick:H=>B(e.row.reserve_id),color:"green",size:"sm"},{default:n(()=>[s("Перемещение")]),_:2},1032,["onClick"])):(o(),r(u,{key:1},[s(" Выполнен ")],64))],64)):m("",!0)]),_:2},1024)]),_:1},8,["rows"]),w("div",O,[l(Q,{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=e=>d.value=e),max:b.value,"max-pages":6,"boundary-links":"","boundary-numbers":"",class:"q-mt-md","direction-links":""},null,8,["modelValue","max"])]),w("div",A,[l(Q,{modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=e=>d.value=e),"boundary-links":!1,"direction-links":!1,max:b.value,"max-pages":6,class:"q-mt-md",input:""},null,8,["modelValue","max"])])],64)):m("",!0)],64)}}};export{le as default};
