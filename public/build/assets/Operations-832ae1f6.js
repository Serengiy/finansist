import{Y as ce,ac as me,ad as A,ae as pe,af as ve,C as fe,r as h,x as V,ag as ge,ah as he,ai as ye,aj as be,ak as we,j as H,al as z,am as F,an as L,ao as _e,a1 as R,J as xe,a2 as Te,aa as Pe,u as ke,k as qe,z as Ce,o as Se,c as Ve,w as _,N as P,b as s,a as n,n as Oe,v as E,S as Qe,t as W,f as j,e as k,P as $}from"./app-73d931b9.js";import{u as Ae,v as J,b as Ee,d as je,e as He,r as Y,s as Ne,f as G,g as K,h as Ue}from"./QSelect-bb49ccbd.js";import{Q as Be}from"./QPage-a8ada1a4.js";import{_ as De}from"./OperationTable-2a2d956f.js";import"./QTable-7376265c.js";import"./QPagination-2f9b74e6.js";const X=ce({name:"QTooltip",inheritAttrs:!1,props:{...Ae,...me,...A,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...A.transitionShow,default:"jump-down"},transitionHide:{...A.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:J},self:{type:String,default:"top middle",validator:J},offset:{type:Array,default:()=>[14,14],validator:Ee},scrollTarget:pe,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...ve],setup(a,{slots:N,emit:v,attrs:y}){let p,c;const r=fe(),{proxy:{$q:t}}=r,u=h(null),b=h(!1),q=V(()=>K(a.anchor,t.lang.rtl)),i=V(()=>K(a.self,t.lang.rtl)),e=V(()=>a.persistent!==!0),{registerTick:w,removeTick:o}=ge(),{registerTimeout:f}=he(),{transitionProps:C,transitionStyle:S}=ye(a),{localScrollTarget:d,changeScrollEvent:Z,unconfigureScrollTarget:ee}=je(a,I),{anchorEl:m,canShow:te,anchorEvents:x}=He({showing:b,configureAnchorEl:ie}),{show:ae,hide:O}=be({showing:b,canShow:te,handleShow:se,handleHide:le,hideOnRouteChange:e,processOnMount:!0});Object.assign(x,{delayShow:ne,delayHide:re});const{showPortal:U,hidePortal:B,renderPortal:oe}=we(r,u,de,"tooltip");if(t.platform.is.mobile===!0){const l={anchorEl:m,innerRef:u,onClickOutside(g){return O(g),g.target.classList.contains("q-dialog__backdrop")&&Pe(g),!0}},Q=V(()=>a.modelValue===null&&a.persistent!==!0&&b.value===!0);H(Q,g=>{(g===!0?Ue:Y)(l)}),z(()=>{Y(l)})}function se(l){U(),w(()=>{c=new MutationObserver(()=>T()),c.observe(u.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),T(),I()}),p===void 0&&(p=H(()=>t.screen.width+"|"+t.screen.height+"|"+a.self+"|"+a.anchor+"|"+t.lang.rtl,T)),f(()=>{U(!0),v("show",l)},a.transitionDuration)}function le(l){o(),B(),D(),f(()=>{B(!0),v("hide",l)},a.transitionDuration)}function D(){c!==void 0&&(c.disconnect(),c=void 0),p!==void 0&&(p(),p=void 0),ee(),F(x,"tooltipTemp")}function T(){Ne({targetEl:u.value,offset:a.offset,anchorEl:m.value,anchorOrigin:q.value,selfOrigin:i.value,maxHeight:a.maxHeight,maxWidth:a.maxWidth})}function ne(l){if(t.platform.is.mobile===!0){G(),document.body.classList.add("non-selectable");const Q=m.value,g=["touchmove","touchcancel","touchend","click"].map(M=>[Q,M,"delayHide","passiveCapture"]);L(x,"tooltipTemp",g)}f(()=>{ae(l)},a.delay)}function re(l){t.platform.is.mobile===!0&&(F(x,"tooltipTemp"),G(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),f(()=>{O(l)},a.hideDelay)}function ie(){if(a.noParentEvent===!0||m.value===null)return;const l=t.platform.is.mobile===!0?[[m.value,"touchstart","delayShow","passive"]]:[[m.value,"mouseenter","delayShow","passive"],[m.value,"mouseleave","delayHide","passive"]];L(x,"anchor",l)}function I(){if(m.value!==null||a.scrollTarget!==void 0){d.value=_e(m.value,a.scrollTarget);const l=a.noParentEvent===!0?T:O;Z(d.value,l)}}function ue(){return b.value===!0?R("div",{...y,ref:u,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",y.class],style:[y.style,S.value],role:"tooltip"},Te(N.default)):null}function de(){return R(xe,C.value,ue)}return z(D),Object.assign(r.proxy,{updatePosition:T}),oe}}),Ie={class:"row justify-center"},Me={class:"row justify-center col-12 q-px-md q-pt-lg q-mb-sm"},ze={class:"text-blue-5 row full-width"},Fe=["onClick"],Le={class:"col-12 bg-white shadow-24 q-pa-md rounded-borders q-mb-md"},Re={class:"row"},We={class:"col-12 text-h6"},$e={class:"col-12 text-h6"},Je={class:"col-12 bg-grey-3 q-px-sm"},Ye={class:"bg-white shadow-3 q-px-sm rounded-borders q-pb-md"},Ge={class:"row"},Ke={class:"row q-mt-sm"},Xe={class:"row q-mt-sm q-ml-sm"},lt={__name:"Operations",setup(a){const v=ke().params.id,y=h([]),p=h(!1),c=h({}),r=h({page:1,rowsPerPage:20,rowsNumber:0}),t=h({purposeQuery:"",categoryQuery:"",dateAt:null,dateFrom:null,dateTo:null,payeeContractorIds:[]});H(t,()=>{r.value.page=1},{deep:!0});const u=async()=>{var i,e,w,o,f,C,S;try{const d=await axios.get("/api/operations",{params:{payeeContractorId:v,paginate:r.value.rowsPerPage,page:r.value.page,dateAt:t.value.dateAt,dateTo:t.value.dateTo,dateFrom:t.value.dateFrom,purposeQuery:t.value.purposeQuery,categoryQuery:t.value.categoryQuery}});y.value=(i=d==null?void 0:d.data)==null?void 0:i.data,r.value.rowsNumber=(w=(e=d.data)==null?void 0:e.meta)==null?void 0:w.total,r.value.page=(f=(o=d.data)==null?void 0:o.meta)==null?void 0:f.current_page,r.value.totalPages=(S=(C=d.data)==null?void 0:C.meta)==null?void 0:S.last_page}catch{P.create({message:"Ошибка получения данных",color:"red",timeout:2e3})}},b=async()=>{try{const i=await axios.get("/api/contractors/"+v);c.value=i.data.data}catch{P.create({message:"Ошибка получения данных",color:"red",timeout:2e3})}},q=async()=>{$.show(),p.value=!0;try{const i=await axios.get(`/api/contractors/${v}/check`);i.data.success?P.create({message:i.data.message,color:"green",timeout:2e3}):P.create({message:"Ошибка проверки",color:"red",timeout:2e3})}catch{P.create({message:"Ошибка проверки",color:"red",timeout:2e3})}p.value=!1,$.hide()};return qe(()=>{b(),u()}),(i,e)=>{const w=Ce("router-link");return Se(),Ve(Be,{class:"bg-grey-3"},{default:_(()=>[s("div",Ie,[s("div",Me,[s("p",ze,[n(w,{to:{name:"ContractorShow",params:{id:Qe(v)}},custom:""},{default:_(({navigate:o})=>[s("div",{onClick:o,class:"cursor-pointer"},[n(Oe,{size:"sm",name:"keyboard_arrow_left"}),e[6]||(e[6]=E(" Назад "))],8,Fe)]),_:1},8,["to"])]),s("div",Le,[e[9]||(e[9]=s("div",{class:"row justify-center"},[s("span",{class:"text-h6"}," Информация о контрагенте ")],-1)),s("div",Re,[s("div",We," Имя контрагента: "+W(c.value.full_name),1),s("div",$e," ИНН контрагента: "+W(c.value.inn_kpp),1),s("div",null,[n(j,{class:"q-my-sm q-mr-sm q-px-sm",dense:"","no-caps":"",size:"md",label:"Проверить",icon:"assignment_turned_in",onClick:q,color:"primary"},{default:_(()=>[n(X,null,{default:_(()=>e[7]||(e[7]=[E(" Проверить операции контрагента ")])),_:1})]),_:1}),n(j,{class:"q-my-sm q-px-md",dense:"","no-caps":"",size:"md",label:"Создать",icon:"add_circle_outline",onClick:q,color:"primary"},{default:_(()=>[n(X,null,{default:_(()=>e[8]||(e[8]=[E(" Создать новую операцию ")])),_:1})]),_:1})])])]),s("div",Je,[s("div",Ye,[e[10]||(e[10]=s("p",{class:"text-h6 text-center"}," Операции контрагента ",-1)),s("div",Ge,[n(k,{class:"col-3 q-px-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:t.value.dateAt,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.dateAt=o),label:"Дата",type:"date"},null,8,["modelValue"]),n(k,{class:"col-3 q-px-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:t.value.categoryQuery,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.categoryQuery=o),label:"Категории"},null,8,["modelValue"]),n(k,{class:"col-3 q-px-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:t.value.purposeQuery,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.purposeQuery=o),label:"Назначение"},null,8,["modelValue"])]),s("div",Ke,[n(k,{class:"col-2 q-px-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:t.value.dateFrom,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.dateFrom=o),label:"Дата начала",type:"date"},null,8,["modelValue"]),n(k,{class:"col-2 q-px-sm",dense:"",clearable:"",outlined:"",filled:"",modelValue:t.value.dateTo,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.dateTo=o),label:"Дата окончания",type:"date"},null,8,["modelValue"])]),s("div",Xe,[n(j,{class:"text-right",dense:"",size:"sm",onClick:u,label:"Применить фильтры",color:"primary"})])]),n(De,{operations:y.value,pagination:r.value,"onUpdate:pagination":e[5]||(e[5]=o=>{r.value=o,u()}),onRefresh:u},null,8,["operations","pagination"])])])])]),_:1})}}};export{lt as default};
