import{u as F,r as S,R as U,o,s,a as c,w as u,F as m,v as g,t as p,l as i,c as Q,b as f,n as q,N as R}from"./app-b6edf1e3.js";import{a as $,Q as A}from"./QTable-c7aadd40.js";import{Q as D}from"./QPagination-e6ad8bb7.js";const I={key:0,class:"rounded-borders shadow-3"},M={key:3,class:"row justify-between"},O={class:"row bg-white justify-center q-pb-md"},G={key:1},L={__name:"RulesTable",props:{rules:Array,pagination:Object},emits:["update:pagination","refresh"],setup(n,{emit:B}){F();const T=n,y=B,j=S([{name:"category",label:"Категория",field:t=>{var a;return(a=t==null?void 0:t.category)==null?void 0:a.name},align:"left"},{name:"contractor",label:"Контрагент",field:t=>{var a;return(a=t==null?void 0:t.contractor)==null?void 0:a.full_name},align:"left"},{name:"purpose_expression",label:"Регулярное выражение",field:"purpose_expression",align:"left"},{name:"actions",label:"Действия",align:"left"}]),E=async t=>{var a;try{const r=await axios.delete(`/api/rules/${t}`);(a=r==null?void 0:r.data)!=null&&a.success&&(R.create({message:"Правило успешно удалено",color:"green",timeout:2e3}),y("refresh"))}catch{R.create({message:"Ошибка удаления",color:"red",timeout:2e3})}},z=t=>{y("update:pagination",{...T.pagination,page:t})};return(t,a)=>{var b;const r=U("router-link");return o(),s("div",null,[n.rules.length?(o(),s("div",I,[c(A,{class:"q-mt-md q-px-sm",rows:n.rules,pagination:{rowsPerPage:(b=n.pagination)==null?void 0:b.rowsPerPage},columns:j.value,"row-key":"id","hide-bottom":"",flat:""},{"body-cell":u(e=>[c($,{item:e},{default:u(()=>{var k,x,w,_,h,v,P,C,N,V;return[e.col.name==="purpose_expression"?(o(),s(m,{key:0},[g(p((k=e.row)==null?void 0:k.purpose_expression),1)],64)):i("",!0),e.col.name==="category"?(o(),Q(r,{key:1,to:{name:"CategoriesEdit",params:{id:(w=(x=e.row)==null?void 0:x.category)==null?void 0:w.id}},target:"_blank"},{default:u(()=>{var l,d;return[g(p((d=(l=e.row)==null?void 0:l.category)==null?void 0:d.name),1)]}),_:2},1032,["to"])):i("",!0),e.col.name==="contractor"?(o(),s(m,{key:2},[(h=(_=e.row)==null?void 0:_.contractor)!=null&&h.name?i("",!0):(o(),s(m,{key:0},[g(" Для всех ")],64)),(P=(v=e.row)==null?void 0:v.contractor)!=null&&P.full_name?(o(),Q(r,{key:1,to:{name:"ContractorShow",params:{id:(N=(C=e.row)==null?void 0:C.contractor)==null?void 0:N.id}},target:"_blank"},{default:u(()=>{var l,d;return[f("div",null,p((d=(l=e.row)==null?void 0:l.contractor)==null?void 0:d.full_name),1)]}),_:2},1032,["to"])):i("",!0)],64)):i("",!0),e.col.name==="actions"?(o(),s("div",M,[c(r,{class:"q-mr-sm",to:{name:"EditRule",params:{id:(V=e==null?void 0:e.row)==null?void 0:V.id}}},{default:u(()=>[c(q,{name:"edit",size:"xs",class:"cursor-pointer",color:"primary"})]),_:2},1032,["to"]),c(q,{onClick:l=>E(e.row.id),name:"delete",size:"xs",class:"cursor-pointer",color:"negative"},null,8,["onClick"])])):i("",!0)]}),_:2},1032,["item"])]),_:1},8,["rows","pagination","columns"]),f("div",O,[c(D,{modelValue:n.pagination.page,"onUpdate:modelValue":[a[0]||(a[0]=e=>n.pagination.page=e),z],max:Math.ceil(n.pagination.rowsNumber/n.pagination.rowsPerPage),"boundary-numbers":"","boundary-links":"","max-pages":10,class:"text-center q-mt-md"},null,8,["modelValue","max"])])])):(o(),s("div",G,a[1]||(a[1]=[f("p",{class:"text-h6 text-center"}," Для этого контрагента правила не установлены ",-1)])))])}}};export{L as _};
