import{r as m,j as P,k as V,U as x,o as i,c as p,w as d,l as u,N as Q,b as c,a as t,e as w,f as b,d as q,s as f,t as v,q as N,F as C,S as B}from"./app-4df6b152.js";import{Q as U}from"./QForm-a72fcf24.js";import{Q as F,a as M}from"./QTable-2b5d2408.js";import{Q as S}from"./QPagination-21b8a7aa.js";import{Q as T}from"./QPage-b9f7ef16.js";import"./QSelect-995ec182.js";const j={class:"bg-white q-ma-sm q-pa-sm"},z={class:"row"},I={class:"row q-mt-md"},$={class:"rounded-borders bg-white shadow-3"},D={class:"row bg-white justify-center q-pb-md rounded-borders"},R={__name:"Index",setup(E){const n=m([]),_=m(!1),a=m({page:1,rowsPerPage:30,rowsNumber:0}),o=m({name:"",inn:""});P(o,()=>{a.value.page=1},{deep:!0});const g=async()=>{var s,l;try{const r=await axios.get("/api/contractors",{params:{...o.value,paginate:a.value.rowsPerPage,page:a.value.page}});n.value=r.data.data,a.value.rowsNumber=(l=(s=r.data)==null?void 0:s.meta)==null?void 0:l.total}catch{Q.create({message:"Ошибка получения данных",color:"red",timeout:2e3})}},y=[{name:"full_name",label:"Имя",field:"full_name",align:"left"},{name:"inn_kpp",label:"ИНН",field:"inn_kpp",align:"left"}],k=async s=>{a.value.page=s,await g()},h=async()=>{await g()};return V(()=>{g()}),(s,l)=>{const r=x("router-link");return n.value?(i(),p(T,{key:0,class:"bg-grey-2"},{default:d(()=>[c("div",j,[t(U,{onSubmit:q(h,["prevent"]),class:"items-center q-pa-md bg-grey-2 rounded-borders"},{default:d(()=>[c("div",z,[t(w,{class:"col-3",clearable:"",dense:"",outlined:"",filled:"",modelValue:o.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>o.value.name=e),label:"Имя"},null,8,["modelValue"]),t(w,{class:"col-3 q-ml-lg",dense:"",clearable:"",outlined:"",filled:"",modelValue:o.value.inn,"onUpdate:modelValue":l[1]||(l[1]=e=>o.value.inn=e),label:"ИНН"},null,8,["modelValue"])]),c("div",I,[t(b,{class:"text-right",dense:"",size:"sm",type:"submit",label:"Применить фильтры",color:"primary"})])]),_:1}),c("div",$,[n.value.length?(i(),p(F,{key:0,class:"q-mt-md q-mx-sm",rows:n.value,columns:y,"row-key":"id",pagination:{rowsPerPage:a.value.rowsPerPage},"hide-bottom":"",flat:"",loading:!n.value.length},{"body-cell":d(e=>[t(M,{class:B(e.row.is_wrong?"bg-red-2":e.row.is_validated?"bg-green-2":""),item:e},{default:d(()=>[e.col.name=="full_name"?(i(),p(r,{key:0,to:`/contractors/${e.row.id}`},{default:d(()=>[f(v(e.row.full_name),1)]),_:2},1032,["to"])):u("",!0),e.col.name=="inn_kpp"?(i(),N(C,{key:1},[f(v(e.row.inn_kpp),1)],64)):u("",!0),e.col.name=="actions"?(i(),p(b,{key:2,dense:"",flat:"",color:"primary",label:"Проверить",onClick:O=>s.checkContractorsOperation(e.row.id),loading:_.value},null,8,["onClick","loading"])):u("",!0)]),_:2},1032,["class","item"])]),_:1},8,["rows","pagination","loading"])):u("",!0),c("div",D,[t(S,{modelValue:a.value.page,"onUpdate:modelValue":[l[2]||(l[2]=e=>a.value.page=e),k],max:Math.ceil(a.value.rowsNumber/a.value.rowsPerPage),"boundary-numbers":"","boundary-links":"","max-pages":10,class:"text-center q-mt-md"},null,8,["modelValue","max"])])])])]),_:1})):u("",!0)}}};export{R as default};
