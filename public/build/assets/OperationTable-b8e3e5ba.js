import{r as $,R as z,o as e,s as o,a as m,w as p,F as d,v as g,t as u,l as n,S as A,b,c as y,q as D,n as L,P as T,N as U}from"./app-b6edf1e3.js";import{a as G,Q as H}from"./QTable-c7aadd40.js";import{Q as J}from"./QPagination-e6ad8bb7.js";const K={key:0,class:"shadow-3"},W={key:0},X={class:"text-primary"},Y={key:0},Z={key:4},aa={class:"row bg-white justify-center q-pb-md rounded-borders"},ea={key:1,class:"row q-mt-sm bg-white justify-center q-pb-md rounded-borders shadow-3"},sa={__name:"OperationTable",props:{operations:Array,pagination:Object},emits:["update:pagination","refresh"],setup(s,{emit:E}){const O=s,S=$([{name:"sber_amountRub",label:"Сумма",field:"sber_amountRub",align:"left"},{name:"categories",label:"Категория",field:"categories",align:"left"},{name:"contractor",label:"Контрагент",field:"payee_contractor",align:"left"},{name:"is_manual",label:"is manual",field:"is_manual",align:"left"},{name:"actions",label:"Действия",align:"left"},{name:"date_at",label:"Дата",field:"date_at",align:"left"},{name:"sber_paymentPurpose",label:"Назначение",field:"sber_paymentPurpose",align:"left"}]),F=E,I=l=>{F("update:pagination",{...O.pagination,page:l})},M=async l=>{var i;T.show();try{const r=await axios.put(`/api/operations/${l==null?void 0:l.id}`,{is_manual:l.is_manual});(i=r==null?void 0:r.data)!=null&&i.success&&U.create({message:"Обновлено",color:"green",timeout:2e3})}catch{U.create({message:"Ошибка обновления",color:"red",timeout:2e3})}T.hide()};return(l,i)=>{const r=z("router-link");return s.operations.length?(e(),o("div",K,[m(H,{flat:"",class:"q-mt-md q-px-sm",rows:s.operations,pagination:{rowsPerPage:s.pagination.rowsPerPage},columns:S.value,"row-key":"id","hide-bottom":""},{"body-cell":p(a=>[m(G,{item:a},{default:p(()=>{var f,w,h,k,x,P,v,V,q,C,N,Q,R,j,B;return[a.col.name==="sber_amountRub"?(e(),o(d,{key:0},[g(u((f=a.row)==null?void 0:f.sber_amountRub),1)],64)):n("",!0),a.col.name==="categories"?(e(),o(d,{key:1},[((w=a.row)==null?void 0:w.categories.length)>1?(e(),o("span",W,[(e(!0),o(d,null,A(a.row.categories,(t,c)=>(e(),o("span",null,[g(u(t.name)+" ",1),b("span",X," ("+u(t.sber_amountRub)+") ",1),c<a.row.categories.length-1?(e(),o("span",Y,", ")):n("",!0)]))),256))])):(e(),o(d,{key:1},[(x=(k=(h=a.row)==null?void 0:h.categories)==null?void 0:k[0])!=null&&x.id?(e(),y(r,{key:0,to:{name:"CategoriesEdit",params:{id:(V=(v=(P=a.row)==null?void 0:P.categories)==null?void 0:v[0])==null?void 0:V.id}},target:"_blank"},{default:p(()=>{var t,c;return[g(u((c=(t=a.row)==null?void 0:t.categories)==null?void 0:c.map(_=>_==null?void 0:_.name).join(", ")),1)]}),_:2},1032,["to"])):n("",!0)],64))],64)):n("",!0),a.col.name==="contractor"?(e(),o(d,{key:2},[(C=(q=a.row)==null?void 0:q.payee_contractor)!=null&&C.id?(e(),y(r,{key:0,to:{name:"ContractorShow",params:{id:(Q=(N=a.row)==null?void 0:N.payee_contractor)==null?void 0:Q.id}},target:"_blank"},{default:p(()=>{var t,c;return[b("div",null,u((c=(t=a.row)==null?void 0:t.payee_contractor)==null?void 0:c.full_name),1)]}),_:2},1032,["to"])):n("",!0)],64)):n("",!0),a.col.name==="is_manual"?(e(),y(D,{key:3,"onUpdate:modelValue":[t=>a.row.is_manual=t,t=>M(a.row)],"model-value":a.row.is_manual},null,8,["onUpdate:modelValue","model-value"])):n("",!0),a.col.name==="actions"?(e(),o("div",Z,[m(r,{to:{name:"OperationEdit",params:{id:(R=a==null?void 0:a.row)==null?void 0:R.id}},class:"cursor-pointer"},{default:p(()=>[m(L,{color:"primary",size:"xs",name:"edit",class:"cursor-pointer"})]),_:2},1032,["to"])])):n("",!0),a.col.name==="date_at"?(e(),o(d,{key:5},[g(u((j=a.row)==null?void 0:j.date_at),1)],64)):n("",!0),a.col.name==="sber_paymentPurpose"?(e(),o(d,{key:6},[g(u((B=a.row)==null?void 0:B.sber_paymentPurpose),1)],64)):n("",!0)]}),_:2},1032,["item"])]),_:1},8,["rows","pagination","columns"]),b("div",aa,[m(J,{modelValue:s.pagination.page,"onUpdate:modelValue":[i[0]||(i[0]=a=>s.pagination.page=a),I],max:Math.ceil(s.pagination.rowsNumber/s.pagination.rowsPerPage),"boundary-numbers":"","boundary-links":"","max-pages":10,class:"text-center q-mt-md"},null,8,["modelValue","max"])])])):(e(),o("div",ea,i[1]||(i[1]=[b("p",{class:"text-h6"}," Для этого контрагента операции не найдены ",-1)])))}}};export{sa as _};
