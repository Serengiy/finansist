import{r as $,A as z,o as t,s as n,a as w,w as k,F as d,v as _,t as m,l as i,x as L,b as x,c as V,q as G,n as H,P as E,N as F}from"./app-d946fa0e.js";import{a as J,Q as K}from"./QTable-2ba8fe71.js";import{Q as W}from"./QPagination-8b1bfbc1.js";/* empty css                                                                       */const X=(s,v)=>{const h=s.__vccOpts||s;for(const[P,N]of v)h[P]=N;return h},Y={key:0,class:"shadow-3"},Z={key:0},ee={class:"text-primary"},ae={key:0},te={key:5},oe={class:"row bg-white justify-center q-pb-md rounded-borders"},ne={key:1,class:"row q-mt-sm bg-white justify-center q-pb-md rounded-borders shadow-3"},re={__name:"OperationTable",props:{operations:Array,pagination:Object},emits:["update:pagination","refresh"],setup(s,{emit:v}){const h=s,P=$([{name:"sber_amountRub",label:"Сумма",field:"sber_amountRub",align:"left",sortable:!0,sort:(a,o)=>parseInt(a,10)-parseInt(o,10)},{name:"categories",label:"Категория",field:"categories",align:"left",sortable:!0,sort:(a,o,r,e)=>{var c,u,f,y;const b=((u=(c=r.categories)==null?void 0:c[0])==null?void 0:u.name)||"",g=((y=(f=e.categories)==null?void 0:f[0])==null?void 0:y.name)||"";return b.localeCompare(g)}},{name:"contractor",label:"Контрагент",field:"payee_contractor",align:"left",sortable:!0,sort:(a,o,r,e)=>{var c,u;const b=((c=r.payee_contractor)==null?void 0:c.full_name)||"",g=((u=e.payee_contractor)==null?void 0:u.full_name)||"";return b.localeCompare(g)}},{name:"is_manual",label:"is manual",field:"is_manual",align:"left",sortable:!0,sort:(a,o)=>Number(a)-Number(o)},{name:"direction",label:"Направление",field:"direction",sortable:!0},{name:"actions",label:"Действия",align:"left"},{name:"date_at",label:"Дата",field:"date_at",align:"left",sortable:!0,sort:(a,o)=>new Date(a)-new Date(o)},{name:"sber_paymentPurpose",label:"Назначение",field:"sber_paymentPurpose",align:"left"}]),N=v,S=a=>{N("update:pagination",{...h.pagination,page:a})},M=async a=>{var o;E.show();try{const r=await axios.put(`/api/operations/${a==null?void 0:a.id}`,{is_manual:a.is_manual});(o=r==null?void 0:r.data)!=null&&o.success&&F.create({message:"Обновлено",color:"green",timeout:2e3})}catch{F.create({message:"Ошибка обновления",color:"red",timeout:2e3})}E.hide()},q=a=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(a);return(a,o)=>{const r=z("router-link");return s.operations.length?(t(),n("div",Y,[w(K,{flat:"",class:"q-mt-md q-px-sm fixed-table",rows:s.operations,pagination:{rowsPerPage:s.pagination.rowsPerPage},columns:P.value,"row-key":"id","hide-bottom":""},{"body-cell":k(e=>[w(J,{item:e,class:"fixed-cell"},{default:k(()=>{var b,g,c,u,f,y,B,Q,R,I,O,U,T,j,A,D;return[e.col.name==="sber_amountRub"?(t(),n(d,{key:0},[_(m(q((b=e.row)==null?void 0:b.sber_amountRub)),1)],64)):i("",!0),e.col.name==="categories"?(t(),n(d,{key:1},[((g=e.row)==null?void 0:g.categories.length)>1?(t(),n("span",Z,[(t(!0),n(d,null,L(e.row.categories,(l,p)=>(t(),n("span",null,[_(m(l.name)+" ",1),x("span",ee," ("+m(q(l.sber_amountRub))+") ",1),p<e.row.categories.length-1?(t(),n("span",ae,", ")):i("",!0)]))),256))])):(t(),n(d,{key:1},[(f=(u=(c=e.row)==null?void 0:c.categories)==null?void 0:u[0])!=null&&f.id?(t(),V(r,{key:0,to:{name:"CategoriesEdit",params:{id:(Q=(B=(y=e.row)==null?void 0:y.categories)==null?void 0:B[0])==null?void 0:Q.id}},target:"_blank"},{default:k(()=>{var l,p;return[_(m((p=(l=e.row)==null?void 0:l.categories)==null?void 0:p.map(C=>C==null?void 0:C.name).join(", ")),1)]}),_:2},1032,["to"])):i("",!0)],64))],64)):i("",!0),e.col.name==="contractor"?(t(),n(d,{key:2},[(I=(R=e.row)==null?void 0:R.payee_contractor)!=null&&I.id?(t(),V(r,{key:0,to:{name:"ContractorShow",params:{id:(U=(O=e.row)==null?void 0:O.payee_contractor)==null?void 0:U.id}},target:"_blank"},{default:k(()=>{var l,p;return[x("div",null,m((p=(l=e.row)==null?void 0:l.payee_contractor)==null?void 0:p.full_name),1)]}),_:2},1032,["to"])):i("",!0)],64)):i("",!0),e.col.name==="is_manual"?(t(),V(G,{key:3,"onUpdate:modelValue":[l=>e.row.is_manual=l,l=>M(e.row)],"model-value":e.row.is_manual},null,8,["onUpdate:modelValue","model-value"])):i("",!0),e.col.name==="direction"?(t(),n(d,{key:4},[_(m((T=e.row)==null?void 0:T.direction),1)],64)):i("",!0),e.col.name==="actions"?(t(),n("div",te,[w(r,{to:{name:"OperationEdit",params:{id:(j=e==null?void 0:e.row)==null?void 0:j.id}},class:"cursor-pointer"},{default:k(()=>[w(H,{color:"primary",size:"xs",name:"edit",class:"cursor-pointer"})]),_:2},1032,["to"])])):i("",!0),e.col.name==="date_at"?(t(),n(d,{key:6},[_(m((A=e.row)==null?void 0:A.date_at),1)],64)):i("",!0),e.col.name==="sber_paymentPurpose"?(t(),n(d,{key:7},[_(m((D=e.row)==null?void 0:D.sber_paymentPurpose),1)],64)):i("",!0)]}),_:2},1032,["item"])]),_:1},8,["rows","pagination","columns"]),x("div",oe,[w(W,{modelValue:s.pagination.page,"onUpdate:modelValue":[o[0]||(o[0]=e=>s.pagination.page=e),S],max:Math.ceil(s.pagination.rowsNumber/s.pagination.rowsPerPage),"boundary-numbers":"","boundary-links":"","max-pages":10,class:"text-center q-mt-md"},null,8,["modelValue","max"])])])):(t(),n("div",ne,o[1]||(o[1]=[x("p",{class:"text-h6"}," Для этого контрагента операции не найдены ",-1)])))}}},ue=X(re,[["__scopeId","data-v-619ea185"]]);export{ue as O,X as _};
