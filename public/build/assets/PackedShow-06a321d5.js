import{y as oe,r as m,L as se,o as l,n as r,d as e,t as d,v as u,q as c,a as p,w as v,i as k,F as _,I as O,c as z,ah as te,P as w,J as Z,g as le,s as ae}from"./app-64dafc3a.js";import{a as G,Q as J}from"./QTable-9f10ca35.js";import{Q as re}from"./QSlideTransition-5ec42607.js";import{Q as S}from"./QFile-eeadd18b.js";import{h as M}from"./html2pdf-792bb947.js";import{_ as ce}from"./ImageCarouselDialog-dda6426c.js";import{_ as ie}from"./ImageDialog-5fc91dda.js";import"./QSelect-fcdeceb1.js";import"./QChip-18101fab.js";import"./position-engine-f936ecea.js";import"./QTooltip-3ff6951b.js";import"./QImg-4607bda3.js";import"./use-render-cache-f6c711e0.js";import"./ClosePopup-9fac0edc.js";import"./use-dialog-plugin-component-00e1baf8.js";const ne={class:"hidden"},de={id:"orderBarcode"},ue=["src"],_e={ref:"",class:"hidden"},pe={id:"barcodeForPdf",style:{transform:"rotateZ(90deg)",width:"200px",height:"210px",display:"flex","flex-direction":"column","justify-content":"end","align-items":"center"}},me={class:"",style:{"font-size":".6rem"}},ve=e("div",{class:"text-left"},"Поставщик: ИП Дятлова.А.А",-1),he={class:"text-left"},ge=e("span",null,"Бренд: MilaVitsa ",-1),fe={class:"text-left"},ye=["src"],we={class:"q-pl-sm q-mb-md",style:{"font-size":".6rem"}},be={class:"q-pa-lg full-height"},ke={class:"row justify-center"},xe={key:0,class:"text-red"},je={key:1,class:"col-sm-9"},Ce={class:"order-details"},qe={class:"row"},Ve={class:"col-12 text-h5"},ze=e("b",null,"Номер заказа: ",-1),Se={class:"row"},Be={class:"col-12 text-h6"},Ie=e("b",null,"Ответственный: ",-1),$e={class:"row text-center q-mt-lg"},Qe={class:"col-12 text-h6"},Pe={key:0},Fe={class:"row justify-center col-12"},Ue={class:"row q-mt-lg"},Te=["onClick"],Re=["src"],De={class:"row col-12 q-mt-lg justify-center"},Ee={key:0,class:"row justify-center col-12 q-mt-lg"},Le=e("div",{class:"col-xs-3 col-sm-2"},[e("p",null,[e("b",null,"Фото товара:")])],-1),Ne={class:"col-xs-3 col-sm-4"},Oe={class:"row justify-center"},Ze=["src"],Ge={class:"col-xs-6 col-sm-6"},Je={class:"row"},Me={class:"col-6"},We={class:"col-6"},Ae={key:0,class:"row justify-center"},He=["src"],Ke={key:1,class:"row justify-center col-12 q-mt-lg"},Xe={class:"row justify-center col-12 q-mt-lg"},Ye=e("div",{class:"col-xs-3 col-sm-2"},[e("p",null,[e("b",null,"Фото бирки:")])],-1),eo={class:"col-xs-3 col-sm-4"},oo={class:"row justify-center"},so=["src"],to={class:"col-xs-6 col-sm-6"},lo={class:"row"},ao={class:"col-6"},ro={class:"col-6"},co={key:0,class:"row justify-center"},io=["src"],no={key:2,class:"row justify-center col-12 q-mt-lg"},uo={class:"row justify-center col-12 q-mt-lg"},_o=e("div",{class:"col-xs-3 col-sm-2"},[e("p",null,[e("b",null,"Фото собранного товара:")])],-1),po={class:"col-xs-3 col-sm-4"},mo={class:"row justify-center"},vo=["src"],ho={class:"col-xs-6 col-sm-6"},go={class:"row"},fo={class:"col-6"},yo={class:"col-6"},wo={key:0,class:"row justify-center"},bo=["src"],ko={key:3,class:"row col-12 q-mt-lg"},xo=e("div",{class:"col-xs-3 col-sm-3"},[e("p",null,[e("b",null,"Печать штрихкода:")])],-1),jo={class:"col-xs-9 col-sm-5"},Co={key:0,class:"row justify-center"},qo={key:4,class:"row col-12 q-mt-lg"},Vo=e("div",{class:"col-xs-3 col-sm-3"},[e("p",null,[e("b",null,"Печать qr-кода:")])],-1),zo={class:"col-xs-9 col-sm-5"},So={class:"row justify-center"},Bo={key:5,class:"row justify-center col-12 q-mt-lg"},Io=e("div",{class:"col-xs-3 col-sm-3"},[e("p",null,[e("b",null,"Компоненты заказа:")])],-1),$o={class:"col-xs-9 col-sm-9"},Qo={class:"q-mr-sm"},Po={class:"col-xs-9 col-sm-9"},Ko={__name:"PackedShow",setup(Fo){const B=oe(),a=m(),x=m(),b=m(!1),j=m(),C=m(null),h=m(),q=m(),I=B.params.orderId,i=m({product_pic:null,product_label:null,product_package:null,components:[]}),$=async()=>{var s;w.show();try{const n=await(await axios.get(`/api/orders/${I}/packed`)).data;if(n.canceled){x.value=n.canceled,w.hide();return}a.value=n.order,h.value=n.barcode,C.value=n.components,j.value=n.mp_barcode,q.value=n.images,W()}catch(o){console.error(o)}try{const o=await axios.get("https://dyatlovait.ru/api/users/"+((s=a==null?void 0:a.value)==null?void 0:s.responsible)),n=o==null?void 0:o.data;a.value.responsible=n==null?void 0:n.fi}catch(o){console.log(o)}w.hide()},W=()=>{const s=new Image;s.onload=()=>{const o=document.createElement("canvas"),n=o.getContext("2d");o.width=s.width,o.height=s.height,n.drawImage(s,0,0),h.value=o.toDataURL("image/png")},s.src="data:image/svg+xml;base64,"+btoa(h.value),h.value=s};se(()=>{B.name==="PackedOrderShow"&&$()}),m(0);const Q={rowsNumber:50},A=async()=>{w.show();try{const s=await axios.post(`/api/orders/${I}/packed`,{supply:i.value},{responseType:"arraybuffer",headers:{"Content-Type":"multipart/form-data"}})}catch(s){console.log(s)}w.hide(),await $()},g=s=>s instanceof File?URL.createObjectURL(s):typeof s=="string"?s:null,H=()=>{var s,o;M(document.getElementById("barcodeForPdf"),{filename:(o=(s=a.value)==null?void 0:s.prop)==null?void 0:o.barcode,html2canvas:{letterRendering:!0,scale:4,backgroundColor:"#f0f0f0"},jsPDF:{unit:"mm",format:[57,29]}})},K=async()=>{M(document.getElementById("orderBarcode"),{filename:"order-sticker",html2canvas:{width:115,height:210,scale:6,letterRendering:!0,x:40,y:-63},jsPDF:{unit:"mm",format:[55,29]}})},f=s=>{Z.create({component:ie,componentProps:{imageUrl:s}})},X=s=>{Z.create({component:ce,componentProps:{images:q.value,currentIndex:s}})},Y=[{label:"Название",name:"name",field:s=>s.product.name,sortable:!1,align:"left",headerStyle:"width: 40%;font-size: 0.9rem;"},{label:"Магазин",name:"shop",field:s=>{var o;return(o=s.reserve)==null?void 0:o.shop},sortable:!1,align:"left",headerStyle:"width: 20%;font-size: 0.9rem;"},{label:"Маркетплейс",name:"marketplace",field:s=>{var o;return(o=s.reserve)==null?void 0:o.marketplace},sortable:!1,align:"left",headerStyle:"width: 20%;font-size: 0.9rem;"},{label:"Цена заказа",name:"price",field:"price",sortable:!1,align:"left",headerStyle:"width: 20%;font-size: 0.9rem;"}],ee=[{label:"Дата отгрузки",name:"reserve_id",field:"price",sortable:!1,align:"left",headerStyle:"width: 40%;font-size: 0.9rem;"},{label:"Цвет",name:"color",field:s=>s.product.name,sortable:!1,align:"left",headerStyle:"width: 20%;font-size: 0.9rem;"},{label:"Размер",name:"size",field:s=>{var o;return(o=s.reserve)==null?void 0:o.shop},sortable:!1,align:"left",headerStyle:"width: 20%;font-size: 0.9rem;"},{label:"Дата заказа",name:"order_date",field:s=>{var o;return(o=s.reserve)==null?void 0:o.marketplace},sortable:!1,align:"left",headerStyle:"width: 20%;font-size: 0.9rem;"}];return(s,o)=>{var n,P,F,U,T,R,D,E,L;return l(),r(_,null,[e("div",ne,[e("div",de,[e("img",{src:j.value,alt:"",height:"100px",style:{transform:"rotateZ(90deg)"},width:"200px"},null,8,ue)])]),e("div",_e,[e("div",pe,[e("div",me,[ve,e("div",he,[e("span",null,"Артикул: "+d((P=(n=a.value)==null?void 0:n.product)==null?void 0:P.code),1),u(),ge]),e("div",fe,[e("span",null," Размер: "+d((U=(F=a.value)==null?void 0:F.prop)==null?void 0:U.size),1),e("span",null," Цвет: "+d((R=(T=a.value)==null?void 0:T.prop)==null?void 0:R.color),1)])]),e("div",null,[e("img",{src:h.value,alt:""},null,8,ye)]),e("div",we," Баркод: "+d((D=a.value)==null?void 0:D.prop.barcode),1)])],512),e("div",be,[e("div",ke,[x.value?(l(),r("div",xe,[e("h5",null,d(x.value),1)])):c("",!0),a.value?(l(),r("div",je,[e("div",null,[e("div",Ce,[e("div",qe,[e("div",Ve,[ze,u(d(a.value.order_id),1)])]),e("div",Se,[e("div",Be,[Ie,u(d(a.value.responsible),1)])]),e("div",$e,[e("div",Qe,[u(" Общая информация "),p(k,{onClick:o[0]||(o[0]=t=>b.value=!b.value)},{default:v(()=>[p(le,{name:b.value?"arrow_drop_up":"arrow_drop_down"},null,8,["name"])]),_:1})])]),p(re,null,{default:v(()=>[b.value?(l(),r("div",Pe,[p(ae,{class:"q-mt-lg"}),a.value?(l(),z(J,{key:0,columns:Y,pagination:Q,rows:[a.value],dense:"","hide-bottom":"","row-key":"id","virtual-scroll":"","wrap-cells":""},{"body-cell":v(t=>[p(G,null,{default:v(()=>{var y,V,N;return[t.col.name=="name"?(l(),r(_,{key:0},[u(d(t.row.product.name),1)],64)):c("",!0),t.col.name=="shop"?(l(),r(_,{key:1},[u(d((y=t.row.reserve)==null?void 0:y.shop),1)],64)):c("",!0),t.col.name=="marketplace"?(l(),r(_,{key:2},[((V=t.row.reserve)==null?void 0:V.marketplace)==="wb"?(l(),r(_,{key:0},[u(" Wildberries ")],64)):c("",!0),((N=t.row.reserve)==null?void 0:N.marketplace)==="ozon"?(l(),r(_,{key:1},[u(" Ozon ")],64)):c("",!0)],64)):c("",!0),t.col.name=="price"?(l(),r(_,{key:3},[u(d(t.row.price),1)],64)):c("",!0)]}),_:2},1024)]),_:1},8,["rows"])):c("",!0),a.value?(l(),z(J,{key:1,columns:ee,pagination:Q,rows:[a.value],dense:"","hide-bottom":"","row-key":"id","virtual-scroll":"","wrap-cells":""},{"body-cell":v(t=>[p(G,null,{default:v(()=>[t.col.name=="color"?(l(),r(_,{key:0},[u(d(t.row.prop.color),1)],64)):c("",!0),t.col.name=="size"?(l(),r(_,{key:1},[u(d(t.row.prop.size),1)],64)):c("",!0),t.col.name=="order_date"?(l(),r(_,{key:2},[u(d(t.row.order_date),1)],64)):c("",!0),t.col.name=="reserve_id"?(l(),r(_,{key:3},[u(d(t.row.shipping_date),1)],64)):c("",!0)]),_:2},1024)]),_:1},8,["rows"])):c("",!0)])):c("",!0)]),_:1})])]),e("div",Fe,[e("div",Ue,[(l(!0),r(_,null,O(q.value,(t,y)=>(l(),r("div",{class:"col-xs-3 cursor-pointer col-md-3 col-lg-3",onClick:V=>X(y)},[e("img",{src:t,alt:"ss",height:"auto",style:{"border-radius":"10px"},width:"100"},null,8,Re)],8,Te))),256))])]),e("div",De,[a.value.product_pic?(l(),r("div",Ee,[Le,e("div",Ne,[e("div",Oe,[e("div",{class:"cursor-pointer",onClick:o[1]||(o[1]=t=>f(a.value.product_pic))},[e("img",{src:a.value.product_pic,width:"100",height:"auto",alt:"image",style:{"border-radius":"10px"}},null,8,Ze)])])]),e("div",Ge,[e("div",Je,[e("div",Me,[p(S,{"bg-color":"green",modelValue:i.value.product_pic,"onUpdate:modelValue":o[2]||(o[2]=t=>i.value.product_pic=t),"label-color":"white",color:"green",outlined:"",label:"Заменить",clearable:"",dense:"",accept:"image/*,.pdf",style:{"max-width":"150px"}},null,8,["modelValue"])]),e("div",We,[i.value.product_pic?(l(),r("div",Ae,[e("div",{class:"cursor-pointer",onClick:o[3]||(o[3]=t=>f(g(i.value.product_pic)))},[e("img",{src:g(i.value.product_pic),width:"100",height:"auto",alt:"image",style:{"border-radius":"10px"}},null,8,He)])])):c("",!0)])])])])):c("",!0),a.value.product_label?(l(),r("div",Ke,[e("div",Xe,[Ye,e("div",eo,[e("div",oo,[e("div",{class:"cursor-pointer",onClick:o[4]||(o[4]=t=>f(a.value.product_label))},[e("img",{src:a.value.product_label,width:"100",height:"auto",alt:"image",style:{"border-radius":"10px"}},null,8,so)])])]),e("div",to,[e("div",lo,[e("div",ao,[p(S,{modelValue:i.value.product_label,"onUpdate:modelValue":o[5]||(o[5]=t=>i.value.product_label=t),"bg-color":"green","label-color":"white",color:"green",outlined:"",label:"Заменить",clearable:"",dense:"",accept:"image/*,.pdf",style:{"max-width":"150px"}},null,8,["modelValue"])]),e("div",ro,[i.value.product_label?(l(),r("div",co,[e("div",{class:"cursor-pointer",onClick:o[6]||(o[6]=t=>f(g(i.value.product_label)))},[e("img",{src:g(i.value.product_label),width:"100",height:"auto",alt:"image",style:{"border-radius":"10px"}},null,8,io)])])):c("",!0)])])])])])):c("",!0),a.value.product_package?(l(),r("div",no,[e("div",uo,[_o,e("div",po,[e("div",mo,[e("div",{class:"cursor-pointer",onClick:o[7]||(o[7]=t=>f(a.value.product_package))},[e("img",{src:a.value.product_package,width:"100",height:"auto",alt:"image",style:{"border-radius":"10px"}},null,8,vo)])])]),e("div",ho,[e("div",go,[e("div",fo,[p(S,{modelValue:i.value.product_package,"onUpdate:modelValue":o[8]||(o[8]=t=>i.value.product_package=t),"bg-color":"green","label-color":"white",color:"green",outlined:"",label:"Заменить",clearable:"",dense:"",accept:"image/*,.pdf",style:{"max-width":"150px"}},null,8,["modelValue"])]),e("div",yo,[i.value.product_package?(l(),r("div",wo,[e("div",{class:"cursor-pointer",onClick:o[9]||(o[9]=t=>f(g(i.value.product_package)))},[e("img",{src:g(i.value.product_package),width:"100",height:"auto",alt:"image",style:{"border-radius":"10px"}},null,8,bo)])])):c("",!0)])])])])])):c("",!0),h.value?(l(),r("div",ko,[xo,e("div",jo,[((L=(E=a.value)==null?void 0:E.reserve)==null?void 0:L.marketplace)==="wb"?(l(),r("div",Co,[e("div",null,[h.value?(l(),z(k,{key:0,color:"green",onClick:H},{default:v(()=>[u("Распечатать")]),_:1})):c("",!0)])])):c("",!0)])])):c("",!0),j.value?(l(),r("div",qo,[Vo,e("div",zo,[e("div",So,[p(k,{color:"green",onClick:K},{default:v(()=>[u("Распечатать")]),_:1})])])])):c("",!0),a.value.components&&C.value?(l(),r("div",Bo,[Io,e("div",$o,[(l(!0),r(_,null,O(a.value.components,(t,y)=>(l(),r("span",Qo,d(++y)+") "+d(t.label),1))),256)),e("div",Po,[p(te,{type:"checkbox",modelValue:i.value.components,"onUpdate:modelValue":o[10]||(o[10]=t=>i.value.components=t),options:C.value},null,8,["modelValue","options"])])])])):c("",!0),e("div",null,[p(k,{class:"q-mt-lg",color:"green",onClick:A},{default:v(()=>[u("Завершить")]),_:1})])])])):c("",!0)])])],64)}}};export{Ko as default};
