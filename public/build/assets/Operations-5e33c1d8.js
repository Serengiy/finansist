import{B as ce,ac as me,ad as E,ae as pe,af as ve,E as fe,r as h,x as V,ag as ge,ah as he,ai as ye,aj as be,ak as we,j as H,al as F,am as R,an as z,ao as _e,I as L,T as Te,J as xe,aa as Pe,u as ke,k as qe,R as Ce,o as Se,c as Ve,w as _,N as P,b as s,a as n,n as Oe,v as A,a3 as Qe,t as W,f as j,e as k,P as $}from"./app-b6edf1e3.js";import{u as Ee,v as J,b as Ae,d as je,e as He,r as G,s as Ne,f as K,g as X,h as Be}from"./QSelect-0453cb93.js";import{Q as Ie}from"./QPage-82bd59c9.js";import{_ as Ue}from"./OperationTable-b8e3e5ba.js";import"./QTable-c7aadd40.js";import"./QPagination-e6ad8bb7.js";const Y=ce({name:"QTooltip",inheritAttrs:!1,props:{...Ee,...me,...E,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...E.transitionShow,default:"jump-down"},transitionHide:{...E.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:J},self:{type:String,default:"top middle",validator:J},offset:{type:Array,default:()=>[14,14],validator:Ae},scrollTarget:pe,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...ve],setup(a,{slots:N,emit:v,attrs:y}){let p,c;const r=fe(),{proxy:{$q:t}}=r,u=h(null),b=h(!1),q=V(()=>X(a.anchor,t.lang.rtl)),i=V(()=>X(a.self,t.lang.rtl)),e=V(()=>a.persistent!==!0),{registerTick:w,removeTick:o}=ge(),{registerTimeout:f}=he(),{transitionProps:C,transitionStyle:S}=ye(a),{localScrollTarget:d,changeScrollEvent:Z,unconfigureScrollTarget:ee}=je(a,D),{anchorEl:m,canShow:te,anchorEvents:T}=He({showing:b,configureAnchorEl:ie}),{show:ae,hide:O}=be({showing:b,canShow:te,handleShow:se,handleHide:le,hideOnRouteChange:e,processOnMount:!0});Object.assign(T,{delayShow:ne,delayHide:re});const{showPortal:B,hidePortal:I,renderPortal:oe}=we(r,u,de,"tooltip");if(t.platform.is.mobile===!0){const l={anchorEl:m,innerRef:u,onClickOutside(g){return O(g),g.target.classList.contains("q-dialog__backdrop")&&Pe(g),!0}},Q=V(()=>a.modelValue===null&&a.persistent!==!0&&b.value===!0);H(Q,g=>{(g===!0?Be:G)(l)}),F(()=>{G(l)})}function se(l){B(),w(()=>{c=new MutationObserver(()=>x()),c.observe(u.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),x(),D()}),p===void 0&&(p=H(()=>t.screen.width+"|"+t.screen.height+"|"+a.self+"|"+a.anchor+"|"+t.lang.rtl,x)),f(()=>{B(!0),v("show",l)},a.transitionDuration)}function le(l){o(),I(),U(),f(()=>{I(!0),v("hide",l)},a.transitionDuration)}function U(){c!==void 0&&(c.disconnect(),c=void 0),p!==void 0&&(p(),p=void 0),ee(),R(T,"tooltipTemp")}function x(){Ne({targetEl:u.value,offset:a.offset,anchorEl:m.value,anchorOrigin:q.value,selfOrigin:i.value,maxHeight:a.maxHeight,maxWidth:a.maxWidth})}function ne(l){if(t.platform.is.mobile===!0){K(),document.body.classList.add("non-selectable");const Q=m.value,g=["touchmove","touchcancel","touchend","click"].map(M=>[Q,M,"delayHide","passiveCapture"]);z(T,"tooltipTemp",g)}f(()=>{ae(l)},a.delay)}function re(l){t.platform.is.mobile===!0&&(R(T,"tooltipTemp"),K(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),f(()=>{O(l)},a.hideDelay)}function ie(){if(a.noParentEvent===!0||m.value===null)return;const l=t.platform.is.mobile===!0?[[m.value,"touchstart","delayShow","passive"]]:[[m.value,"mouseenter","delayShow","passive"],[m.value,"mouseleave","delayHide","passive"]];z(T,"anchor",l)}function D(){if(m.value!==null||a.scrollTarget!==void 0){d.value=_e(m.value,a.scrollTarget);const l=a.noParentEvent===!0?x:O;Z(d.value,l)}}function ue(){return b.value===!0?L("div",{...y,ref:u,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",y.class],style:[y.style,S.value],role:"tooltip"},xe(N.default)):null}function de(){return L(Te,C.value,ue)}return F(U),Object.assign(r.proxy,{updatePosition:x}),oe}}),De={class:"row justify-center"},Me={class:"row justify-center col-12 q-px-md q-pt-lg q-mb-sm"},Fe={class:"text-blue-5 row full-width"},Re=["onClick"],ze={class:"col-12 bg-white shadow-24 q-pa-md rounded-borders q-mb-md"},Le={class:"row"},We={class:"col-12 text-h6"},$e={class:"col-12 text-h6"},Je={class:"col-12 bg-grey-3 q-px-sm"},Ge={class:"bg-white shadow-3 q-px-sm rounded-borders q-pb-md"},Ke={class:"row"},Xe={class:"row q-mt-sm"},Ye={class:"row q-mt-sm q-ml-sm"},lt={__name:"Operations",setup(a){const v=ke().params.id,y=h([]),p=h(!1),c=h({}),r=h({page:1,rowsPerPage:20,rowsNumber:0}),t=h({purposeQuery:"",categoryQuery:"",dateAt:null,dateFrom:null,dateTo:null,payeeContractorIds:[]});H(t,()=>{r.value.page=1},{deep:!0});const u=async()=>{var i,e,w,o,f,C,S;try{const d=await axios.get("/api/operations",{params:{payeeContractorId:v,paginate:r.value.rowsPerPage,page:r.value.page,dateAt:t.value.dateAt,dateTo:t.value.dateTo,dateFrom:t.value.dateFrom,purposeQuery:t.value.purposeQuery,categoryQuery:t.value.categoryQuery}});y.value=(i=d==null?void 0:d.data)==null?void 0:i.data,r.value.rowsNumber=(w=(e=d.data)==null?void 0:e.meta)==null?void 0:w.total,r.value.page=(f=(o=d.data)==null?void 0:o.meta)==null?void 0:f.current_page,r.value.totalPages=(S=(C=d.data)==null?void 0:C.meta)==null?void 0:S.last_page}catch{P.create({message:"Ошибка получения данных",color:"red",timeout:2e3})}},b=async()=>{try{const i=await axios.get("/api/contractors/"+v);c.value=i.data.data}catch{P.create({message:"Ошибка получения данных",color:"red",timeout:2e3})}},q=async()=>{$.show(),p.value=!0;try{const i=await axios.get(`/api/contractors/${v}/check`);i.data.success?P.create({message:i.data.message,color:"green",timeout:2e3}):P.create({message:"Ошибка проверки",color:"red",timeout:2e3})}catch{P.create({message:"Ошибка проверки",color:"red",timeout:2e3})}p.value=!1,$.hide()};return qe(()=>{b(),u()}),(i,e)=>{const w=Ce("router-link");return Se(),Ve(Ie,{class:"bg-grey-3"},{default:_(()=>[s("div",De,[s("div",Me,[s("p",Fe,[n(w,{to:{name:"ContractorShow",params:{id:Qe(v)}},custom:""},{default:_(({navigate:o})=>[s("div",{onClick:o,class:"cursor-pointer"},[n(Oe,{size:"sm",name:"keyboard_arrow_left"}),e[6]||(e[6]=A(" Назад "))],8,Re)]),_:1},8,["to"])]),s("div",ze,[e[9]||(e[9]=s("div",{class:"row justify-center"},[s("span",{class:"text-h6"}," Информация о контрагенте ")],-1)),s("div",Le,[s("div",We," Имя контрагента: "+W(c.value.full_name),1),s("div",$e," ИНН контрагента: "+W(c.value.inn_kpp),1),s("div",null,[n(j,{class:"q-my-sm q-mr-sm q-px-sm",dense:"","no-caps":"",size:"md",label:"Проверить",icon:"assignment_turned_in",onClick:q,color:"primary"},{default:_(()=>[n(Y,null,{default:_(()=>e[7]||(e[7]=[A(" Проверить операции контрагента ")])),_:1})]),_:1}),n(j,{class:"q-my-sm q-px-md",dense:"","no-caps":"",size:"md",label:"Создать",icon:"add_circle_outline",onClick:q,color:"primary"},{default:_(()=>[n(Y,null,{default:_(()=>e[8]||(e[8]=[A(" Создать новую операцию ")])),_:1})]),_:1})])])]),s("div",Je,[s("div",Ge,[e[10]||(e[10]=s("p",{class:"text-h6 text-center"}," Операции контрагента ",-1)),s("div",Ke,[n(k,{class:"col-3 q-px-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:t.value.dateAt,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.dateAt=o),label:"Дата",type:"date"},null,8,["modelValue"]),n(k,{class:"col-3 q-px-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:t.value.categoryQuery,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.categoryQuery=o),label:"Категории"},null,8,["modelValue"]),n(k,{class:"col-3 q-px-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:t.value.purposeQuery,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.purposeQuery=o),label:"Назначение"},null,8,["modelValue"])]),s("div",Xe,[n(k,{class:"col-2 q-px-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:t.value.dateFrom,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.dateFrom=o),label:"Дата начала",type:"date"},null,8,["modelValue"]),n(k,{class:"col-2 q-px-sm",dense:"",clearable:"",outlined:"",filled:"",modelValue:t.value.dateTo,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.dateTo=o),label:"Дата окончания",type:"date"},null,8,["modelValue"])]),s("div",Ye,[n(j,{class:"text-right",dense:"",size:"sm",onClick:u,label:"Применить фильтры",color:"primary"})])]),n(Ue,{operations:y.value,pagination:r.value,"onUpdate:pagination":e[5]||(e[5]=o=>{r.value=o,u()}),onRefresh:u},null,8,["operations","pagination"])])])])]),_:1})}}};export{lt as default};
