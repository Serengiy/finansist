var _e=Object.defineProperty;var Ie=(s,a,e)=>a in s?_e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[a]=e;var o=(s,a,e)=>(Ie(s,typeof a!="symbol"?a+"":a,e),e);import{u as Ee,i as He,r as v,j as Qe,k as Ve,o as Ce,c as Fe,w as C,l as Ne,P as pe,m as U,N as $,a as g,b as z,e as ce,d as Z,n as be,f as oe,t as Le}from"./app-4df6b152.js";import{Q as he,d as xe}from"./QDate-0a29584c.js";import{Q as ge,a as j}from"./QSelect-995ec182.js";import{Q as ze}from"./QForm-a72fcf24.js";import{Q as Re}from"./QPage-b9f7ef16.js";import{_ as We}from"./OperationTable-ba754ae8.js";import{t as q,g as we,c as H,m as Be,a as Ae,b as Ge,d as Xe,s as ie,e as Te,f as Ue,h as $e,i as ke,j as Ze,l as ve,k as je,w as De,n as Ke,o as F}from"./format-04e7afb3.js";import{a as Me,s as Je,b as Se}from"./startOfQuarter-72f9bb24.js";import"./QTable-2b5d2408.js";import"./QPagination-21b8a7aa.js";function et(s,a){const e=q(s,a==null?void 0:a.in),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function tt(s,a){const e=q(s,a==null?void 0:a.in);return e.setDate(1),e.setHours(0,0,0,0),e}function rt(s,a){var m,D,T,k;const e=we(),t=(a==null?void 0:a.weekStartsOn)??((D=(m=a==null?void 0:a.locale)==null?void 0:m.options)==null?void 0:D.weekStartsOn)??e.weekStartsOn??((k=(T=e.locale)==null?void 0:T.options)==null?void 0:k.weekStartsOn)??0,r=q(s,a==null?void 0:a.in),n=r.getDay(),c=(n<t?-7:0)+6-(n-t);return r.setDate(r.getDate()+c),r.setHours(23,59,59,999),r}function at(s,a){const e=q(s,a==null?void 0:a.in),t=e.getMonth(),r=t-t%3+3;return e.setMonth(r,0),e.setHours(23,59,59,999),e}function st(){return Object.assign({},we())}function nt(s,a){const e=q(s,a==null?void 0:a.in).getDay();return e===0?7:e}function ot(s,a){const e=it(a)?new a(0):H(a,0);return e.setFullYear(s.getFullYear(),s.getMonth(),s.getDate()),e.setHours(s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),e}function it(s){var a;return typeof s=="function"&&((a=s.prototype)==null?void 0:a.constructor)===s}const lt=10;class Ye{constructor(){o(this,"subPriority",0)}validate(a,e){return!0}}class ut extends Ye{constructor(a,e,t,r,n){super(),this.value=a,this.validateValue=e,this.setValue=t,this.priority=r,n&&(this.subPriority=n)}validate(a,e){return this.validateValue(a,this.value,e)}set(a,e,t){return this.setValue(a,e,this.value,t)}}class ct extends Ye{constructor(e,t){super();o(this,"priority",lt);o(this,"subPriority",-1);this.context=e||(r=>H(t,r))}set(e,t){return t.timestampIsSet?e:H(e,ot(e,this.context))}}class f{run(a,e,t,r){const n=this.parse(a,e,t,r);return n?{setter:new ut(n.value,this.validate,this.set,this.priority,this.subPriority),rest:n.rest}:null}validate(a,e,t){return!0}}class dt extends f{constructor(){super(...arguments);o(this,"priority",140);o(this,"incompatibleTokens",["R","u","t","T"])}parse(e,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"});case"GGGGG":return r.era(e,{width:"narrow"});case"GGGG":default:return r.era(e,{width:"wide"})||r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"})}}set(e,t,r){return t.era=r,e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}}const h={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},_={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function x(s,a){return s&&{value:a(s.value),rest:s.rest}}function p(s,a){const e=a.match(s);return e?{value:parseInt(e[0],10),rest:a.slice(e[0].length)}:null}function I(s,a){const e=a.match(s);if(!e)return null;if(e[0]==="Z")return{value:0,rest:a.slice(1)};const t=e[1]==="+"?1:-1,r=e[2]?parseInt(e[2],10):0,n=e[3]?parseInt(e[3],10):0,c=e[5]?parseInt(e[5],10):0;return{value:t*(r*Be+n*Ae+c*Ge),rest:a.slice(e[0].length)}}function qe(s){return p(h.anyDigitsSigned,s)}function b(s,a){switch(s){case 1:return p(h.singleDigit,a);case 2:return p(h.twoDigits,a);case 3:return p(h.threeDigits,a);case 4:return p(h.fourDigits,a);default:return p(new RegExp("^\\d{1,"+s+"}"),a)}}function le(s,a){switch(s){case 1:return p(h.singleDigitSigned,a);case 2:return p(h.twoDigitsSigned,a);case 3:return p(h.threeDigitsSigned,a);case 4:return p(h.fourDigitsSigned,a);default:return p(new RegExp("^-?\\d{1,"+s+"}"),a)}}function fe(s){switch(s){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Oe(s,a){const e=a>0,t=e?a:1-a;let r;if(t<=50)r=s||100;else{const n=t+50,c=Math.trunc(n/100)*100,m=s>=n%100;r=s+c-(m?100:0)}return e?r:1-r}function Pe(s){return s%400===0||s%4===0&&s%100!==0}class wt extends f{constructor(){super(...arguments);o(this,"priority",130);o(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(e,t,r){const n=c=>({year:c,isTwoDigitYear:t==="yy"});switch(t){case"y":return x(b(4,e),n);case"yo":return x(r.ordinalNumber(e,{unit:"year"}),n);default:return x(b(t.length,e),n)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r){const n=e.getFullYear();if(r.isTwoDigitYear){const m=Oe(r.year,n);return e.setFullYear(m,0,1),e.setHours(0,0,0,0),e}const c=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(c,0,1),e.setHours(0,0,0,0),e}}class ft extends f{constructor(){super(...arguments);o(this,"priority",130);o(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(e,t,r){const n=c=>({year:c,isTwoDigitYear:t==="YY"});switch(t){case"Y":return x(b(4,e),n);case"Yo":return x(r.ordinalNumber(e,{unit:"year"}),n);default:return x(b(t.length,e),n)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r,n){const c=Xe(e,n);if(r.isTwoDigitYear){const D=Oe(r.year,c);return e.setFullYear(D,0,n.firstWeekContainsDate),e.setHours(0,0,0,0),ie(e,n)}const m=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(m,0,n.firstWeekContainsDate),e.setHours(0,0,0,0),ie(e,n)}}class mt extends f{constructor(){super(...arguments);o(this,"priority",130);o(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(e,t){return le(t==="R"?4:t.length,e)}set(e,t,r){const n=H(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Te(n)}}class yt extends f{constructor(){super(...arguments);o(this,"priority",130);o(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(e,t){return le(t==="u"?4:t.length,e)}set(e,t,r){return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}}class pt extends f{constructor(){super(...arguments);o(this,"priority",120);o(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,t,r){switch(t){case"Q":case"QQ":return b(t.length,e);case"Qo":return r.ordinalNumber(e,{unit:"quarter"});case"QQQ":return r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(e,{width:"wide",context:"formatting"})||r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}}class bt extends f{constructor(){super(...arguments);o(this,"priority",120);o(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,t,r){switch(t){case"q":case"qq":return b(t.length,e);case"qo":return r.ordinalNumber(e,{unit:"quarter"});case"qqq":return r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(e,{width:"wide",context:"standalone"})||r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}}class ht extends f{constructor(){super(...arguments);o(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);o(this,"priority",110)}parse(e,t,r){const n=c=>c-1;switch(t){case"M":return x(p(h.month,e),n);case"MM":return x(b(2,e),n);case"Mo":return x(r.ordinalNumber(e,{unit:"month"}),n);case"MMM":return r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(e,{width:"wide",context:"formatting"})||r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}}class xt extends f{constructor(){super(...arguments);o(this,"priority",110);o(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(e,t,r){const n=c=>c-1;switch(t){case"L":return x(p(h.month,e),n);case"LL":return x(b(2,e),n);case"Lo":return x(r.ordinalNumber(e,{unit:"month"}),n);case"LLL":return r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(e,{width:"wide",context:"standalone"})||r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}}function gt(s,a,e){const t=q(s,e==null?void 0:e.in),r=Ue(t,e)-a;return t.setDate(t.getDate()-r*7),q(t,e==null?void 0:e.in)}class vt extends f{constructor(){super(...arguments);o(this,"priority",100);o(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(e,t,r){switch(t){case"w":return p(h.week,e);case"wo":return r.ordinalNumber(e,{unit:"week"});default:return b(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r,n){return ie(gt(e,r,n),n)}}function Dt(s,a,e){const t=q(s,e==null?void 0:e.in),r=$e(t,e)-a;return t.setDate(t.getDate()-r*7),t}class Tt extends f{constructor(){super(...arguments);o(this,"priority",100);o(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(e,t,r){switch(t){case"I":return p(h.week,e);case"Io":return r.ordinalNumber(e,{unit:"week"});default:return b(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r){return Te(Dt(e,r))}}const kt=[31,28,31,30,31,30,31,31,30,31,30,31],Mt=[31,29,31,30,31,30,31,31,30,31,30,31];class Yt extends f{constructor(){super(...arguments);o(this,"priority",90);o(this,"subPriority",1);o(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(e,t,r){switch(t){case"d":return p(h.date,e);case"do":return r.ordinalNumber(e,{unit:"date"});default:return b(t.length,e)}}validate(e,t){const r=e.getFullYear(),n=Pe(r),c=e.getMonth();return n?t>=1&&t<=Mt[c]:t>=1&&t<=kt[c]}set(e,t,r){return e.setDate(r),e.setHours(0,0,0,0),e}}class qt extends f{constructor(){super(...arguments);o(this,"priority",90);o(this,"subpriority",1);o(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(e,t,r){switch(t){case"D":case"DD":return p(h.dayOfYear,e);case"Do":return r.ordinalNumber(e,{unit:"date"});default:return b(t.length,e)}}validate(e,t){const r=e.getFullYear();return Pe(r)?t>=1&&t<=366:t>=1&&t<=365}set(e,t,r){return e.setMonth(0,r),e.setHours(0,0,0,0),e}}function me(s,a,e){var O,E,Y,u;const t=we(),r=(e==null?void 0:e.weekStartsOn)??((E=(O=e==null?void 0:e.locale)==null?void 0:O.options)==null?void 0:E.weekStartsOn)??t.weekStartsOn??((u=(Y=t.locale)==null?void 0:Y.options)==null?void 0:u.weekStartsOn)??0,n=q(s,e==null?void 0:e.in),c=n.getDay(),D=(a%7+7)%7,T=7-r,k=a<0||a>6?a-(c+T)%7:(D+T)%7-(c+T)%7;return Me(n,k,e)}class Ot extends f{constructor(){super(...arguments);o(this,"priority",90);o(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(e,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,n){return e=me(e,r,n),e.setHours(0,0,0,0),e}}class Pt extends f{constructor(){super(...arguments);o(this,"priority",90);o(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(e,t,r,n){const c=m=>{const D=Math.floor((m-1)/7)*7;return(m+n.weekStartsOn+6)%7+D};switch(t){case"e":case"ee":return x(b(t.length,e),c);case"eo":return x(r.ordinalNumber(e,{unit:"day"}),c);case"eee":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeeee":return r.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,n){return e=me(e,r,n),e.setHours(0,0,0,0),e}}class _t extends f{constructor(){super(...arguments);o(this,"priority",90);o(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(e,t,r,n){const c=m=>{const D=Math.floor((m-1)/7)*7;return(m+n.weekStartsOn+6)%7+D};switch(t){case"c":case"cc":return x(b(t.length,e),c);case"co":return x(r.ordinalNumber(e,{unit:"day"}),c);case"ccc":return r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"ccccc":return r.day(e,{width:"narrow",context:"standalone"});case"cccccc":return r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(e,{width:"wide",context:"standalone"})||r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,n){return e=me(e,r,n),e.setHours(0,0,0,0),e}}function It(s,a,e){const t=q(s,e==null?void 0:e.in),r=nt(t,e),n=a-r;return Me(t,n,e)}class Et extends f{constructor(){super(...arguments);o(this,"priority",90);o(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(e,t,r){const n=c=>c===0?7:c;switch(t){case"i":case"ii":return b(t.length,e);case"io":return r.ordinalNumber(e,{unit:"day"});case"iii":return x(r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),n);case"iiiii":return x(r.day(e,{width:"narrow",context:"formatting"}),n);case"iiiiii":return x(r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),n);case"iiii":default:return x(r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),n)}}validate(e,t){return t>=1&&t<=7}set(e,t,r){return e=It(e,r),e.setHours(0,0,0,0),e}}class Ht extends f{constructor(){super(...arguments);o(this,"priority",80);o(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(e,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(fe(r),0,0,0),e}}class Qt extends f{constructor(){super(...arguments);o(this,"priority",80);o(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(e,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(fe(r),0,0,0),e}}class Vt extends f{constructor(){super(...arguments);o(this,"priority",80);o(this,"incompatibleTokens",["a","b","t","T"])}parse(e,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(fe(r),0,0,0),e}}class Ct extends f{constructor(){super(...arguments);o(this,"priority",70);o(this,"incompatibleTokens",["H","K","k","t","T"])}parse(e,t,r){switch(t){case"h":return p(h.hour12h,e);case"ho":return r.ordinalNumber(e,{unit:"hour"});default:return b(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,r){const n=e.getHours()>=12;return n&&r<12?e.setHours(r+12,0,0,0):!n&&r===12?e.setHours(0,0,0,0):e.setHours(r,0,0,0),e}}class Ft extends f{constructor(){super(...arguments);o(this,"priority",70);o(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(e,t,r){switch(t){case"H":return p(h.hour23h,e);case"Ho":return r.ordinalNumber(e,{unit:"hour"});default:return b(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,r){return e.setHours(r,0,0,0),e}}class Nt extends f{constructor(){super(...arguments);o(this,"priority",70);o(this,"incompatibleTokens",["h","H","k","t","T"])}parse(e,t,r){switch(t){case"K":return p(h.hour11h,e);case"Ko":return r.ordinalNumber(e,{unit:"hour"});default:return b(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.getHours()>=12&&r<12?e.setHours(r+12,0,0,0):e.setHours(r,0,0,0),e}}class Lt extends f{constructor(){super(...arguments);o(this,"priority",70);o(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(e,t,r){switch(t){case"k":return p(h.hour24h,e);case"ko":return r.ordinalNumber(e,{unit:"hour"});default:return b(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,r){const n=r<=24?r%24:r;return e.setHours(n,0,0,0),e}}class zt extends f{constructor(){super(...arguments);o(this,"priority",60);o(this,"incompatibleTokens",["t","T"])}parse(e,t,r){switch(t){case"m":return p(h.minute,e);case"mo":return r.ordinalNumber(e,{unit:"minute"});default:return b(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setMinutes(r,0,0),e}}class Rt extends f{constructor(){super(...arguments);o(this,"priority",50);o(this,"incompatibleTokens",["t","T"])}parse(e,t,r){switch(t){case"s":return p(h.second,e);case"so":return r.ordinalNumber(e,{unit:"second"});default:return b(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setSeconds(r,0),e}}class Wt extends f{constructor(){super(...arguments);o(this,"priority",30);o(this,"incompatibleTokens",["t","T"])}parse(e,t){const r=n=>Math.trunc(n*Math.pow(10,-t.length+3));return x(b(t.length,e),r)}set(e,t,r){return e.setMilliseconds(r),e}}class Bt extends f{constructor(){super(...arguments);o(this,"priority",10);o(this,"incompatibleTokens",["t","T","x"])}parse(e,t){switch(t){case"X":return I(_.basicOptionalMinutes,e);case"XX":return I(_.basic,e);case"XXXX":return I(_.basicOptionalSeconds,e);case"XXXXX":return I(_.extendedOptionalSeconds,e);case"XXX":default:return I(_.extended,e)}}set(e,t,r){return t.timestampIsSet?e:H(e,e.getTime()-ke(e)-r)}}class At extends f{constructor(){super(...arguments);o(this,"priority",10);o(this,"incompatibleTokens",["t","T","X"])}parse(e,t){switch(t){case"x":return I(_.basicOptionalMinutes,e);case"xx":return I(_.basic,e);case"xxxx":return I(_.basicOptionalSeconds,e);case"xxxxx":return I(_.extendedOptionalSeconds,e);case"xxx":default:return I(_.extended,e)}}set(e,t,r){return t.timestampIsSet?e:H(e,e.getTime()-ke(e)-r)}}class Gt extends f{constructor(){super(...arguments);o(this,"priority",40);o(this,"incompatibleTokens","*")}parse(e){return qe(e)}set(e,t,r){return[H(e,r*1e3),{timestampIsSet:!0}]}}class Xt extends f{constructor(){super(...arguments);o(this,"priority",20);o(this,"incompatibleTokens","*")}parse(e){return qe(e)}set(e,t,r){return[H(e,r),{timestampIsSet:!0}]}}const Ut={G:new dt,y:new wt,Y:new ft,R:new mt,u:new yt,Q:new pt,q:new bt,M:new ht,L:new xt,w:new vt,I:new Tt,d:new Yt,D:new qt,E:new Ot,e:new Pt,c:new _t,i:new Et,a:new Ht,b:new Qt,B:new Vt,h:new Ct,H:new Ft,K:new Nt,k:new Lt,m:new zt,s:new Rt,S:new Wt,X:new Bt,x:new At,t:new Gt,T:new Xt},$t=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Zt=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,jt=/^'([^]*?)'?$/,Kt=/''/g,Jt=/\S/,St=/[a-zA-Z]/;function de(s,a,e,t){var W,Q,V,K,J,N,S,ee;const r=()=>H((t==null?void 0:t.in)||e,NaN),n=st(),c=(t==null?void 0:t.locale)??n.locale??Ze,m=(t==null?void 0:t.firstWeekContainsDate)??((Q=(W=t==null?void 0:t.locale)==null?void 0:W.options)==null?void 0:Q.firstWeekContainsDate)??n.firstWeekContainsDate??((K=(V=n.locale)==null?void 0:V.options)==null?void 0:K.firstWeekContainsDate)??1,D=(t==null?void 0:t.weekStartsOn)??((N=(J=t==null?void 0:t.locale)==null?void 0:J.options)==null?void 0:N.weekStartsOn)??n.weekStartsOn??((ee=(S=n.locale)==null?void 0:S.options)==null?void 0:ee.weekStartsOn)??0;if(!a)return s?r():q(e,t==null?void 0:t.in);const T={firstWeekContainsDate:m,weekStartsOn:D,locale:c},k=[new ct(t==null?void 0:t.in,e)],O=a.match(Zt).map(w=>{const y=w[0];if(y in ve){const M=ve[y];return M(w,c.formatLong)}return w}).join("").match($t),E=[];for(let w of O){!(t!=null&&t.useAdditionalWeekYearTokens)&&je(w)&&De(w,a,s),!(t!=null&&t.useAdditionalDayOfYearTokens)&&Ke(w)&&De(w,a,s);const y=w[0],M=Ut[y];if(M){const{incompatibleTokens:te}=M;if(Array.isArray(te)){const re=E.find(ae=>te.includes(ae.token)||ae.token===y);if(re)throw new RangeError(`The format string mustn't contain \`${re.fullToken}\` and \`${w}\` at the same time`)}else if(M.incompatibleTokens==="*"&&E.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);E.push({token:y,fullToken:w});const B=M.run(s,w,c.match,T);if(!B)return r();k.push(B.setter),s=B.rest}else{if(y.match(St))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");if(w==="''"?w="'":y==="'"&&(w=er(w)),s.indexOf(w)===0)s=s.slice(w.length);else return r()}}if(s.length>0&&Jt.test(s))return r();const Y=k.map(w=>w.priority).sort((w,y)=>y-w).filter((w,y,M)=>M.indexOf(w)===y).map(w=>k.filter(y=>y.priority===w).sort((y,M)=>M.subPriority-y.subPriority)).map(w=>w[0]);let u=q(e,t==null?void 0:t.in);if(isNaN(+u))return r();const R={};for(const w of Y){if(!w.validate(u,T))return r();const y=w.set(u,R,T);Array.isArray(y)?(u=y[0],Object.assign(R,y[1])):u=y}return u}function er(s){return s.match(jt)[1].replace(Kt,"'")}const tr={class:"row"},rr={class:"row q-mt-md"},ar={class:"row justify-between items-center q-mt-md"},sr={class:"row justify-between full-width"},nr={class:"text-body2 q-px-sm q-py-xs bg-primary text-white rounded-borders"},br={__name:"Index",setup(s){const a=Ee(),e=He(),t=v([]),r=v(null),n=a.query,c=v([]),m=v([]),D=v([]),T=v([]),k=v(!1);v([]),v([]);const O=v([]),E=v(0),Y=v({page:1,rowsPerPage:50,rowsNumber:0}),u=v({dateFrom:"",dateTo:"",splitFilter:null,categoryQuery:"",parentCategoryId:null,categories:[],pizzerias:[],purpose_expression:"",sberDirection:null}),R=v(""),W=v(""),Q=v(!1),V=v(!1),K=d=>{u.value.dateFrom=d,R.value=xe.formatDate(d,"DD.MM.YYYY"),Q.value=!1},J=d=>{u.value.dateTo=d,W.value=xe.formatDate(d,"DD.MM.YYYY"),V.value=!1};Qe(u,()=>{Y.value.page=1},{deep:!0});const N=async d=>{var i,l,A,P,se,ne,G,ye;pe.show();try{const L=await U.get("/api/operations/",{params:{...u.value,isSplit:(i=u.value.splitFilter)==null?void 0:i.value,page:Y.value.page,contractorIds:T.value,categoryIds:u.value.categories.map(X=>X.id),pizzeriaIds:u.value.pizzerias.map(X=>X.id)||r.value}});c.value=(l=L==null?void 0:L.data)==null?void 0:l.data,E.value=c.value.reduce((X,ue)=>X+(ue==null?void 0:ue.sber_amountRub),0),Y.value.rowsNumber=(P=(A=L.data)==null?void 0:A.meta)==null?void 0:P.total,Y.value.page=(ne=(se=L.data)==null?void 0:se.meta)==null?void 0:ne.current_page,Y.value.totalPages=(ye=(G=L.data)==null?void 0:G.meta)==null?void 0:ye.last_page}catch{$.create({message:"Ошибка получения данных",color:"red",timeout:2e3})}pe.hide()},S=async()=>{try{$.create({message:"Синхронизация запущена!"});const d=await U.get("/api/get-operations");$.create({message:"Синхронизация закончена!"})}catch{$.create({message:"Ошибка! Синхронизация транзакций не удалась!",color:"error"})}},ee=async(d,i,l)=>{d.length>3?(k.value=!0,await w(d),i(()=>O.value),k.value=!1):(O.value=[],i(()=>O.value))},w=async(d="")=>{try{const i=await U.get("/api/categories",{params:{q:d||""}});O.value=i.data.data}catch{$.create({message:"Ошибка получения данных",color:"red",timeout:2e3})}},y=async(d,i,l)=>{d.length>3?(k.value=!0,await M(d),i(()=>m.value)):(m.value=[],i(()=>m.value))},M=async d=>{k.value=!0;try{const i=await U.get("/api/contractors",{params:{q:d||"",ids:T.value}});m.value=i.data.data,D.value=m.value.map(l=>({...l,value:l.id,label:l.name})),T.value=m.value.map(l=>l.id)}catch{}finally{k.value=!1}},te=async()=>{try{const d=await U.get("/api/pizzerias");t.value=d.data.data}catch{}},B=()=>{JSON.parse(JSON.stringify(u.value)),N()};Ve(async()=>{await te(),await re(n),T.value.length&&await M(),r.value.length&&(u.value.pizzerias=t.value.filter(d=>r.value.includes(String(d.id)))),await N()});const re=async d=>{if(T.value=d.contractorIds||[],u.value.parentCategoryId=d.parentCategoryId||null,r.value=d.pizzeriaIds||[],d!=null&&d.groupBy&&(d!=null&&d.date)){const{groupBy:i,date:l}=d;switch(i){case"monthly":{const P=de(l,"MM-yyyy",new Date);u.value.dateFrom=F(tt(P),"yyyy-MM-dd"),u.value.dateTo=F(et(P),"yyyy-MM-dd");break}case"weekly":{const[P,se]=l.split("-").map(Number),ne=new Date(se,0,1),G=Se(ne,P-1);u.value.dateFrom=F(ie(G,{weekStartsOn:1}),"yyyy-MM-dd"),u.value.dateTo=F(rt(G,{weekStartsOn:1}),"yyyy-MM-dd");break}case"quarterly":{const P=de(l,"Q-yyyy",new Date);u.value.dateFrom=F(Je(P),"yyyy-MM-dd"),u.value.dateTo=F(at(P),"yyyy-MM-dd");break}default:const A=de(l,"d-MM-yyyy",new Date);u.value.dateFrom=F(A,"yyyy-MM-dd"),u.value.dateTo=F(A,"yyyy-MM-dd")}}},ae=async()=>{await e.push({path:a.path,query:{}})};return(d,i)=>c.value?(Ce(),Fe(Re,{key:0},{default:C(()=>[g(ze,{onSubmit:Z(B,["prevent"]),class:"items-center q-pa-md bg-grey-4"},{default:C(()=>[z("div",tr,[g(ce,{class:"col-2 q-px-sm q-mt-sm",dense:"",outlined:"",filled:"",modelValue:R.value,"onUpdate:modelValue":i[3]||(i[3]=l=>R.value=l),label:"Дата начала",readonly:"",onClick:i[4]||(i[4]=Z(l=>Q.value=!0,["stop"]))},{append:C(()=>[g(be,{name:"event",onClick:i[0]||(i[0]=Z(l=>Q.value=!0,["stop"]))})]),default:C(()=>[g(ge,{modelValue:Q.value,"onUpdate:modelValue":i[2]||(i[2]=l=>Q.value=l),anchor:"bottom left",self:"top left"},{default:C(()=>[g(he,{modelValue:u.value.dateFrom,"onUpdate:modelValue":[i[1]||(i[1]=l=>u.value.dateFrom=l),K],mask:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),g(ce,{class:"col-2 q-px-sm q-mt-sm",dense:"",outlined:"",filled:"",modelValue:W.value,"onUpdate:modelValue":i[8]||(i[8]=l=>W.value=l),label:"Дата окончания",readonly:"",onClick:i[9]||(i[9]=Z(l=>V.value=!0,["stop"]))},{append:C(()=>[g(be,{name:"event",onClick:i[5]||(i[5]=Z(l=>V.value=!0,["stop"]))})]),default:C(()=>[g(ge,{modelValue:V.value,"onUpdate:modelValue":i[7]||(i[7]=l=>V.value=l),anchor:"bottom left",self:"top left"},{default:C(()=>[g(he,{modelValue:u.value.dateFrom,"onUpdate:modelValue":[i[6]||(i[6]=l=>u.value.dateFrom=l),J],mask:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),g(j,{class:"col-3 q-px-sm q-mt-sm",dense:"",outlined:"",filled:"",flat:"",label:"Категория",modelValue:u.value.categories,"onUpdate:modelValue":i[10]||(i[10]=l=>u.value.categories=l),options:O.value,"option-label":"name",clearable:"",multiple:"","use-input":"",borderless:"","use-chips":"",onFilter:ee,loading:k.value},null,8,["modelValue","options","loading"]),g(j,{class:"col-3 q-px-sm q-mt-sm",dense:"",outlined:"",filled:"",label:"Пиццерия",modelValue:u.value.pizzerias,"onUpdate:modelValue":i[11]||(i[11]=l=>u.value.pizzerias=l),options:t.value,clearable:"","option-label":"name","option-value":"id",multiple:""},null,8,["modelValue","options"]),g(ce,{class:"col-3 q-px-sm q-mt-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:u.value.purpose_expression,"onUpdate:modelValue":i[12]||(i[12]=l=>u.value.purpose_expression=l),label:"Регулярное выражение"},null,8,["modelValue"]),g(j,{class:"col-3 q-px-sm q-mt-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:u.value.sberDirection,"onUpdate:modelValue":i[13]||(i[13]=l=>u.value.sberDirection=l),label:"Тип операции",options:[{label:"DEBIT",value:"DEBIT"},{label:"CREDIT",value:"CREDIT"}]},null,8,["modelValue"]),g(j,{class:"col-6 q-mt-sm",dense:"",outlined:"",filled:"",label:"Контрагенты (получатели)",modelValue:D.value,"onUpdate:modelValue":i[14]||(i[14]=l=>D.value=l),options:m.value,"use-input":"",multiple:"",clearable:"","option-label":"name",onFilter:y,loading:k.value},null,8,["modelValue","options","loading"]),g(j,{class:"col-3 q-px-sm q-mt-sm",clearable:"",dense:"",outlined:"",filled:"",modelValue:u.value.splitFilter,"onUpdate:modelValue":i[15]||(i[15]=l=>u.value.splitFilter=l),label:"Разделенные операции",options:[{label:"Все",value:null},{label:"Разделенные",value:!0},{label:"Неразделенные",value:!1}]},null,8,["modelValue"])]),z("div",rr,[g(oe,{class:"text-right q-pa-xs",dense:"",size:"sm",type:"submit",label:"Применить фильтры",color:"primary"}),g(oe,{class:"text-right q-ml-sm q-pa-xs",dense:"",size:"sm",onClick:ae,label:"Очистить фильтры",color:"primary"})]),z("div",ar,[z("div",sr,[z("div",null,[g(oe,{onClick:S,label:"Синхронизироать тразакции",dense:"",size:"sm",color:"primary",class:"q-mr-sm q-pa-xs"}),g(oe,{to:"/operations/create",class:"text-right q-pa-xs",dense:"",size:"sm",label:"Создать операцию",color:"primary"})]),z("div",null,[z("p",nr,"Итого: "+Le(E.value),1)])])])]),_:1}),g(We,{operations:c.value,pagination:Y.value,"onUpdate:pagination":i[16]||(i[16]=l=>{Y.value=l,N()}),onRefresh:N},null,8,["operations","pagination"])]),_:1})):Ne("",!0)}};export{br as default};
