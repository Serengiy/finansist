import{u as D,r as i,c as b,o as E,a as o,b as k,w as f,d as s,N as P,e as n,f as r,Q as N,g as Q,t as l,h as j,i as d,j as u,F as c,n as z}from"./app-f80ab9e6.js";import{Q as F,a as C}from"./QForm-be91830e.js";import{Q as M,a as O}from"./QTable-f6d249ab.js";import{Q as J}from"./QPage-a14373ce.js";const R={class:"row justify-between"},A={class:"row q-mt-md"},G={class:"row justify-between items-center q-mt-md"},H={class:"row"},K={class:"text-h6 text-green"},L={class:"text-h6 text-red q-ml-lg"},W={class:"text-h6 text-blue q-ml-lg"},ae={__name:"Index",setup(X){const q=D(),p=i([]),w=i([]),_=i([]),v=i(0),y=i(0),x=i({page:3,rowsPerPage:50,rowsNumber:0}),t=i({dateFrom:"",dateTo:"",type:null,category:null}),V=async m=>{try{const a=await axios.get("/api/operations/",{params:{...t.value}});p.value=a.data.operations,w.value=a.data.categories,_.value=a.data.types,v.value=a.data.totalIncome,y.value=a.data.totalExpense}catch{P.create({message:"Ошибка получения данных",color:"red",timeout:2e3})}},I=[{name:"categories",label:"Категория",field:"categories",align:"left"},{name:"description",label:"Описание",field:"description",align:"left"},{name:"types",label:"Тип",field:"types",align:"left"},{name:"is_completed",label:"Статус",field:"is_completed",align:"left"},{name:"date",label:"Дата",field:"date",align:"left"},{name:"amount",label:"Сумма",field:"amount",align:"left"}],T=m=>{x.value=m,h()},h=()=>{JSON.parse(JSON.stringify(t.value)),V()},g=m=>new Intl.NumberFormat("ru-RU",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(m),U=b(()=>g(v.value)),B=b(()=>g(y.value)),S=b(()=>g(v.value-Math.abs(y.value)));return E(()=>{q.name=="OperationIndex"&&V()}),(m,a)=>p.value?(o(),k(J,{key:0},{default:f(()=>[n(C,{onSubmit:j(h,["prevent"]),class:"items-center q-pa-md bg-grey-4"},{default:f(()=>[r("div",R,[n(N,{class:"col-2",clearable:"",dense:"",outlined:"",filled:"",modelValue:t.value.dateFrom,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.dateFrom=e),label:"Дата начала",type:"date"},null,8,["modelValue"]),n(N,{class:"col-2",dense:"",clearable:"",outlined:"",filled:"",modelValue:t.value.dateTo,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value.dateTo=e),label:"Дата окончания",type:"date"},null,8,["modelValue"]),n(F,{class:"col-3",dense:"",clearable:"",outlined:"",filled:"",modelValue:t.value.type,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.type=e),options:_.value,label:"Фильтр по типам","option-value":"id","option-label":"name"},null,8,["modelValue","options"]),n(F,{class:"col-3",dense:"",clearable:"",outlined:"",filled:"",modelValue:t.value.category,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.category=e),options:w.value,label:"Фильтр по категориям","option-value":"id","option-label":"name"},null,8,["modelValue","options"])]),r("div",A,[n(Q,{class:"text-right",dense:"",size:"sm",type:"submit",label:"Применить фильтры",color:"primary"})]),r("div",G,[r("div",H,[r("div",K," Прибыль: "+l(U.value),1),r("div",L," Расход: "+l(B.value),1),r("div",W," Разница: "+l(S.value),1)]),r("div",null,[n(Q,{to:"/operations/create",class:"text-right",dense:"",size:"sm",label:"Создать операцию",color:"primary"})])])]),_:1}),p.value.length?(o(),k(M,{key:0,class:"q-mt-md q-px-sm",rows:p.value,pagination:x.value,columns:I,"rows-per-page-options":[5,10,25,50,100],"row-key":"id","onUpdate:pagination":T},{"body-cell":f(e=>[n(O,{class:z(e.row.is_wrong?"bg-red-2":e.row.is_validated?"bg-green-2":""),item:e},{default:f(()=>[e.col.name=="description"?(o(),d(c,{key:0},[u(l(e.row.description),1)],64)):s("",!0),e.col.name=="types"?(o(),d(c,{key:1},[u(l(e.row.types),1)],64)):s("",!0),e.col.name=="date"?(o(),d(c,{key:2},[u(l(e.row.date),1)],64)):s("",!0),e.col.name==="amount"?(o(),d(c,{key:3},[u(l(g(e.row.amount)),1)],64)):s("",!0),e.col.name=="categories"?(o(),d(c,{key:4},[u(l(e.row.categories),1)],64)):s("",!0),e.col.name=="is_completed"?(o(),d(c,{key:5},[u(l(e.row.is_completed?"Выполнено":"Не выполнено"),1)],64)):s("",!0)]),_:2},1032,["class","item"])]),_:1},8,["rows","pagination"])):s("",!0)]),_:1})):s("",!0)}};export{ae as default};
